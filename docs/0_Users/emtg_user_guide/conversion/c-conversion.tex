\chapter{Conversion Scripts}
\label{chap:conversion}

\ac{EMTG} also comes packaged with convenient conversion scripts to aid users in the process of iteratively increasing the fidelity of a mission. This allows users to, for example, generate a low-fidelity trajectory to some planetary body that may include some intermediate flyby, improve the fidelity of that trajectory by automatically transitioning flybys into multiple phases, and then further improve the fidelity by properly modeling transitions in and out of spheres of influence of the visited bodies. This requires some small amount of manual scripting which is covered in the Flybys tutorial located at {\tt docs/0\_Users/tutorial/Tutorial\_Docs/4\_Flybys.pdf}. These conversion scripts are available in {\tt PyEMTG/Converters/} and {\tt PyEMTG/HighFidelity}.

\section{Convert To Single Phase Journeys}
A typical process for converting a low fidelity \ac{EMTG} mission which contains flybys of some planetary bodies to a higher fidelity mission starts with the {\tt convert\_to\_single\_phase\_journeys.py} script available in {\tt PyEMTG/Converters/}. This script removes bodies from the flyby sequence, and instead insert them as new Journey departure and arrival points. Thus, a mission is expanded into more Journeys, however each of these Journeys are of a single phase rather than multi-phase (pre- and post- flyby). This does not improve upon the fidelity of the mission, but does provide a stepping stone for later conversion scripts to do so. This change can be made manually, however the converter script also automatically populates the initial guess for the new Journey with values and appropriately renames the relevant decision variables. Thus, if the Journey structure is the only thing that is changed, \ac{EMTG} should produce exactly the same trajectory with either Journey structure. For specific details and an example of the usage of this converter, see the Flybys tutorial at {\tt docs/0\_Users/tutorial/Tutorial\_Docs/4\_Flybys.pdf}.


\section{High Fidelity Conversion}
Converting to a high-fidelity mission requires an \ac{EMTG} options file with single phase Journeys and an obtained solution. The conversion scripts that are used to accomplish this are found in {\tt PyEMTG/HighFidelity}. Users interact exclusively with the {\tt HighFidelityDriverFunction.py} script. This conversion transitions the launch and any flybys into a more accurate representation that includes body sphere of influence departure and entry. Thus, additional Universe files defining central bodies of the launch body and any flyby bodies are required.

\begin{alertbox}{\emtgknownissue{High fidelity conversion scripts require universe files of precise names.}{High Fidelity Conversion Universe File Name Issue}}
    \noindent High fidelity {\tt .emtgopt} files created when using the high fidelity conversion scripts will not work unless the universe files for the launch body and any converted flyby bodies share the exact name as that used in the menu of bodies for the main Sun {\tt .emtg\_universe} file used in the lower fidelity {\tt .emtgopt} file.
\end{alertbox}

It is important to note that the high-fidelity conversion script applies to flybys only. The final Journey's arrival is not converted to a higher fidelity sphere of influence to free point arrival orbit. This must instead be done manually, which is demonstrated in the Journey Boundaries tutorial located at {\tt docs/0\_Users/tutorial/Tutorial\_Docs/3\_JourneyBoundaries.pdf}. Like the single phase conversion script, the high-fidelity flyby conversion script also generates initial guesses for the new decision variables. These decision variables do not necessarily produce a feasible solution without optimization; however, they do provide a good starting point for \ac{EMTG}. For specific details and an example of the usage of this converter, see the Flybys tutorial at {\tt docs/0\_Users/tutorial/Tutorial\_Docs/4\_Flybys.pdf}.


