<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MissionEvent &#8212; EMTG python  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=61cd365c" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=12dfc556" />
    <script src="../_static/documentation_options.js?v=7f41d439"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for MissionEvent</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright (c) 2024 The Regents of the University of Colorado.</span>
<span class="c1"># All Other Rights Reserved.</span>

<span class="kn">import</span> <span class="nn">EOM</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">copy</span>


<div class="viewcode-block" id="MissionEvent">
<a class="viewcode-back" href="../PyEMTG/MissionEvent.html#MissionEvent.MissionEvent">[docs]</a>
<span class="k">class</span> <span class="nc">MissionEvent</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">lock</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">inputcell</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">EventNumber</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1">#index of event</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">JulianDate</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1">#Julian Ephemeris Date of event</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GregorianDate</span> <span class="o">=</span> <span class="s1">&#39;banana&#39;</span> <span class="c1">#gregorian date (MM/DD/YYYY) of event</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">=</span> <span class="s1">&#39;shampoo&#39;</span> <span class="c1">#what class of event? Launch? Thrust? Coast? Flyby? etc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Location</span> <span class="o">=</span> <span class="s1">&#39;bottle&#39;</span> <span class="c1">#where did the event take place</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">=</span> <span class="mf">1.0e-4</span> <span class="c1">#how long is the time step in days?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Altitude</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1">#altitude for flybys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BdotR</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1">#for flybys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BdotT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1">#for flybys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RightAscension</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#RA for maneuvers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Declination</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#DEC for maneuvers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C3</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#C3 for arrivals and departures</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span> <span class="c1">#6-vector</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DeltaVorThrustVectorControl</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span> <span class="c1">#3-vector</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Thrust</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span> <span class="c1">#3-vector</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DVmagorThrottle</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#for impulses or thrust arcs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AvailableThrust</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#for thrust arcs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Isp</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1">#for all propulsive maneuvers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AvailablePower</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#for thrust arcs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#kg/s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Mass</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1">#Mass after event occurs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Number_of_Active_Engines</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#number of thrusters firing at the center of this arc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ActivePower</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#how much power is currently being used by the thrust system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ThrottleLevel</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eventlabel</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parse_input_line</span><span class="p">(</span><span class="n">inputcell</span><span class="p">)</span>

<div class="viewcode-block" id="MissionEvent.parse_input_line">
<a class="viewcode-back" href="../PyEMTG/MissionEvent.html#MissionEvent.MissionEvent.parse_input_line">[docs]</a>
    <span class="k">def</span> <span class="nf">parse_input_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputcell</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputcell</span><span class="p">)):</span>
            <span class="n">inputcell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputcell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">inputcell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">or</span> <span class="n">inputcell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="n">inputcell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

        

        <span class="bp">self</span><span class="o">.</span><span class="n">EventNumber</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">JulianDate</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GregorianDate</span> <span class="o">=</span> <span class="n">inputcell</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">=</span> <span class="n">inputcell</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Location</span> <span class="o">=</span> <span class="n">inputcell</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Altitude</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BdotR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BdotT</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RightAscension</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Declination</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">12</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">13</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">14</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">15</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">16</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">17</span><span class="p">])]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DeltaVorThrustVectorControl</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">18</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">19</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">20</span><span class="p">])]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Thrust</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">21</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">22</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">23</span><span class="p">])]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DVmagorThrottle</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">24</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">inputcell</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;impulse&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AvailableThrust</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AvailableThrust</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">25</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">inputcell</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;LV-supplied&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Isp</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">elif</span> <span class="n">inputcell</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;UNHANDLED EVENT TYPE&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Isp</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Isp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">26</span><span class="p">])</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">AvailablePower</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">27</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">28</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Mass</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">29</span><span class="p">])</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputcell</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">31</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Number_of_Active_Engines</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">30</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputcell</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">32</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ActivePower</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">inputcell</span><span class="p">[</span><span class="mi">31</span><span class="p">])</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputcell</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">33</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ThrottleLevel</span> <span class="o">=</span> <span class="n">inputcell</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span></div>



<div class="viewcode-block" id="MissionEvent.PlotEvent">
<a class="viewcode-back" href="../PyEMTG/MissionEvent.html#MissionEvent.MissionEvent.PlotEvent">[docs]</a>
    <span class="k">def</span> <span class="nf">PlotEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">GraphicsObject</span><span class="p">,</span> <span class="n">LU</span><span class="p">,</span> <span class="n">TU</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="p">,</span> <span class="n">BeforeMatchPoint</span><span class="p">,</span> <span class="n">CustomLabel</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">ode</span>
        <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
        <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">proj3d</span>
        <span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">FancyArrowPatch</span>
        <span class="c1">#switch between different event types</span>
        <span class="n">pX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">pZ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span> <span class="o">!=</span> <span class="s1">&#39;Journey central body&#39;</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">spiceypy</span>
            <span class="n">journey_central_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">central_body</span>
            <span class="k">if</span> <span class="n">journey_central_body</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Mars&#39;</span><span class="p">,</span><span class="s1">&#39;Jupiter&#39;</span><span class="p">,</span><span class="s1">&#39;Uranus&#39;</span><span class="p">,</span><span class="s1">&#39;Neptune&#39;</span><span class="p">,</span><span class="s1">&#39;Pluto&#39;</span><span class="p">]:</span>
                <span class="n">journey_central_body</span> <span class="o">=</span> <span class="n">journey_central_body</span> <span class="o">+</span> <span class="s1">&#39; Barycenter&#39;</span>

            <span class="k">if</span> <span class="n">journey_central_body</span> <span class="o">!=</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">:</span>
                <span class="n">body_state</span><span class="p">,</span> <span class="n">LT</span> <span class="o">=</span> <span class="n">spiceypy</span><span class="o">.</span><span class="n">spkezr</span><span class="p">(</span><span class="n">journey_central_body</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JulianDate</span> <span class="o">-</span> <span class="mf">2451545.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">86400.0</span><span class="p">,</span> <span class="s1">&#39;J2000&#39;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">)</span>

                <span class="n">pX</span> <span class="o">+=</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">pY</span> <span class="o">+=</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">pZ</span> <span class="o">+=</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s2">&quot;launch&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s2">&quot;departure&quot;</span><span class="p">:</span>
            <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pX</span><span class="p">,</span> <span class="n">pY</span><span class="p">,</span> <span class="n">pZ</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">)</span>
            <span class="n">BeforeMatchPoint</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s2">&quot;begin_spiral&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s2">&quot;end_spiral&quot;</span><span class="p">:</span>
            <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pX</span><span class="p">,</span> <span class="n">pY</span><span class="p">,</span> <span class="n">pZ</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">)</span>
            <span class="n">BeforeMatchPoint</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s2">&quot;upwr_flyby&quot;</span><span class="p">:</span>
            <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pX</span><span class="p">,</span> <span class="n">pY</span><span class="p">,</span> <span class="n">pZ</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\circlearrowleft$&#39;</span><span class="p">)</span>
            <span class="n">BeforeMatchPoint</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s2">&quot;pwr_flyby&quot;</span><span class="p">:</span>
            <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pX</span><span class="p">,</span> <span class="n">pY</span><span class="p">,</span> <span class="n">pZ</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\circlearrowleft$&#39;</span><span class="p">)</span>
            <span class="n">BeforeMatchPoint</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s2">&quot;chem_burn&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">DVmagorThrottle</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">:</span>
            <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pX</span><span class="p">,</span> <span class="n">pY</span><span class="p">,</span> <span class="n">pZ</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;SFthrust&quot;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s2">&quot;PSBIthrust&quot;</span><span class="p">,</span> <span class="s2">&quot;coast&quot;</span><span class="p">,</span> <span class="s1">&#39;nav-coast&#39;</span><span class="p">,</span> <span class="s1">&#39;Scoast&#39;</span><span class="p">,</span> <span class="s2">&quot;force-coast&quot;</span><span class="p">,</span> <span class="s2">&quot;LT_spiral&quot;</span><span class="p">,</span> <span class="s1">&#39;end_spiral&#39;</span><span class="p">,</span> <span class="s1">&#39;begin_spiral&#39;</span><span class="p">]:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;coast&quot;</span><span class="p">,</span> <span class="s1">&#39;Scoast&#39;</span><span class="p">,</span> <span class="s1">&#39;nav-coast&#39;</span><span class="p">]:</span>
                <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span>
                <span class="n">weight</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;LT_spiral&#39;</span><span class="p">,</span> <span class="s1">&#39;end_spiral&#39;</span><span class="p">,</span> <span class="s1">&#39;begin_spiral&#39;</span><span class="p">]:</span>
                <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span>
                <span class="n">weight</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;SFthrust&quot;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s2">&quot;PSBIthrust&quot;</span><span class="p">]:</span>
                <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span>
                <span class="n">weight</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">ShowThrustVectors</span><span class="p">:</span>
                    <span class="n">ControlVector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Thrust</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">AvailableThrust</span> <span class="o">*</span> <span class="n">LU</span> <span class="o">*</span> <span class="mf">0.1</span>
                    <span class="n">T_length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Thrust</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">AvailableThrust</span> <span class="o">*</span> <span class="n">LU</span> <span class="o">*</span> <span class="mf">0.1</span>
                    <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">ControlVector</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
                    <span class="n">Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">ControlVector</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
                    <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">ControlVector</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>

                    <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span> <span class="o">!=</span> <span class="s1">&#39;Journey central body&#39;</span><span class="p">:</span>
                        <span class="kn">import</span> <span class="nn">spiceypy</span>
                        <span class="n">journey_central_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">central_body</span>
                        <span class="k">if</span> <span class="n">journey_central_body</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Mars&#39;</span><span class="p">,</span><span class="s1">&#39;Jupiter&#39;</span><span class="p">,</span><span class="s1">&#39;Uranus&#39;</span><span class="p">,</span><span class="s1">&#39;Neptune&#39;</span><span class="p">,</span><span class="s1">&#39;Pluto&#39;</span><span class="p">]:</span>
                            <span class="n">journey_central_body</span> <span class="o">=</span> <span class="n">journey_central_body</span> <span class="o">+</span> <span class="s1">&#39; Barycenter&#39;</span>

                        <span class="k">if</span> <span class="n">journey_central_body</span> <span class="o">!=</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">:</span>
                            <span class="n">body_state</span><span class="p">,</span> <span class="n">LT</span> <span class="o">=</span> <span class="n">spiceypy</span><span class="o">.</span><span class="n">spkezr</span><span class="p">(</span><span class="n">journey_central_body</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JulianDate</span> <span class="o">-</span> <span class="mf">2451545.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">86400.0</span><span class="p">,</span> <span class="s1">&#39;J2000&#39;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">)</span>

                            <span class="n">X</span> <span class="o">+=</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="n">Y</span> <span class="o">+=</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                            <span class="n">Z</span> <span class="o">+=</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

                    <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;violet&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span>
                <span class="n">weight</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1"># comment out to turn off event dots</span>
            <span class="c1">#GraphicsObject.scatter(self.SpacecraftState[0], self.SpacecraftState[1], self.SpacecraftState[2], s=1, c=color, marker=&#39;o&#39;)</span>

            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">ShowPropagatedTrajectory</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;begin_spiral&#39;</span><span class="p">,</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="c1">#plot ONLY a forward propagation </span>
                    <span class="n">ManeuverPointState</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
                    <span class="n">ManeuverPointState</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">)</span> <span class="o">/</span> <span class="n">LU</span>
                    <span class="n">ManeuverPointState</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="n">TU</span>
                    <span class="n">ForwardIntegrateObject</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">EOM</span><span class="o">.</span><span class="n">EOM_inertial_2body</span><span class="p">)</span><span class="o">.</span><span class="n">set_integrator</span><span class="p">(</span><span class="s1">&#39;dop853&#39;</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1.0e-8</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1.0e-8</span><span class="p">)</span>
                    <span class="n">ForwardIntegrateObject</span><span class="o">.</span><span class="n">set_initial_value</span><span class="p">(</span><span class="n">ManeuverPointState</span><span class="p">)</span><span class="o">.</span><span class="n">set_f_params</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">set_jac_params</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

                    <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">*</span> <span class="mf">86400.0</span> <span class="o">/</span> <span class="n">TU</span> <span class="o">/</span> <span class="mi">100</span>
                    <span class="n">StateHistoryForward</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">while</span> <span class="n">ForwardIntegrateObject</span><span class="o">.</span><span class="n">successful</span><span class="p">()</span> <span class="ow">and</span> <span class="n">ForwardIntegrateObject</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">*</span> <span class="mf">86400.0</span> <span class="o">/</span> <span class="n">TU</span><span class="p">:</span>
                        <span class="n">ForwardIntegrateObject</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">ForwardIntegrateObject</span><span class="o">.</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span>
                        <span class="n">StateHistoryForward</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ForwardIntegrateObject</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">LU</span><span class="p">)</span>
                    <span class="n">StateHistoryForward</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

                    <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">Y</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">Z</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">StateLine</span> <span class="ow">in</span> <span class="n">StateHistoryForward</span><span class="p">:</span>
                        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span> <span class="c1">#thrusting!</span>
                    <span class="n">CenterPointState</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
                    <span class="n">CenterPointState</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">)</span> <span class="o">/</span> <span class="n">LU</span>
                    <span class="n">CenterPointState</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="n">TU</span>
                    <span class="n">CenterPointStateAfterManeuver</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">CenterPointState</span><span class="p">)</span>
                    <span class="n">CenterPointStateAfterManeuver</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DeltaVorThrustVectorControl</span><span class="p">)</span> <span class="o">*</span> <span class="n">TU</span> <span class="o">/</span><span class="n">LU</span>

                    <span class="n">ForwardIntegrateObject</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">EOM</span><span class="o">.</span><span class="n">EOM_inertial_2body</span><span class="p">)</span><span class="o">.</span><span class="n">set_integrator</span><span class="p">(</span><span class="s1">&#39;dop853&#39;</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1.0e-8</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1.0e-8</span><span class="p">)</span>
                    <span class="n">ForwardIntegrateObject</span><span class="o">.</span><span class="n">set_initial_value</span><span class="p">(</span><span class="n">CenterPointStateAfterManeuver</span><span class="p">)</span><span class="o">.</span><span class="n">set_f_params</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">set_jac_params</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

                    <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">*</span> <span class="mf">86400.0</span> <span class="o">/</span> <span class="n">TU</span> <span class="o">/</span> <span class="mi">100</span>
                    <span class="n">StateHistoryForward</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">epoch</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JulianDate</span> <span class="o">-</span> <span class="mf">2451545.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">86400.0</span>
                    <span class="k">while</span> <span class="n">ForwardIntegrateObject</span><span class="o">.</span><span class="n">successful</span><span class="p">()</span> <span class="ow">and</span> <span class="n">ForwardIntegrateObject</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">*</span> <span class="mf">86400.0</span> <span class="o">/</span> <span class="n">TU</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">:</span>
                        <span class="n">epoch</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">TU</span>
                        <span class="n">stateArray</span> <span class="o">=</span> <span class="n">ForwardIntegrateObject</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">ForwardIntegrateObject</span><span class="o">.</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span>
                        <span class="n">state</span> <span class="o">=</span> <span class="p">[</span><span class="n">stateArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">LU</span><span class="p">,</span> <span class="n">stateArray</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">LU</span><span class="p">,</span> <span class="n">stateArray</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">LU</span><span class="p">,</span> <span class="n">epoch</span><span class="p">]</span>
                        <span class="n">StateHistoryForward</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

                    <span class="n">BackwardIntegrateObject</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">EOM</span><span class="o">.</span><span class="n">EOM_inertial_2body</span><span class="p">)</span><span class="o">.</span><span class="n">set_integrator</span><span class="p">(</span><span class="s1">&#39;dop853&#39;</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1.0e-8</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1.0e-8</span><span class="p">)</span>
                    <span class="n">BackwardIntegrateObject</span><span class="o">.</span><span class="n">set_initial_value</span><span class="p">(</span><span class="n">CenterPointState</span><span class="p">)</span><span class="o">.</span><span class="n">set_f_params</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">set_jac_params</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

                    <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">*</span> <span class="mf">86400.0</span> <span class="o">/</span> <span class="n">TU</span> <span class="o">/</span> <span class="mi">100</span>
                    <span class="n">StateHistoryBackward</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">epoch</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JulianDate</span> <span class="o">-</span> <span class="mf">2451545.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">86400.0</span>
                    <span class="k">while</span> <span class="n">BackwardIntegrateObject</span><span class="o">.</span><span class="n">successful</span><span class="p">()</span> <span class="ow">and</span> <span class="n">BackwardIntegrateObject</span><span class="o">.</span><span class="n">t</span> <span class="o">&gt;</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">*</span> <span class="mf">86400.0</span> <span class="o">/</span> <span class="n">TU</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">:</span>   
                        <span class="n">epoch</span> <span class="o">-=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">TU</span>
                        <span class="n">stateArray</span> <span class="o">=</span> <span class="n">BackwardIntegrateObject</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">BackwardIntegrateObject</span><span class="o">.</span><span class="n">t</span> <span class="o">-</span> <span class="n">dt</span><span class="p">)</span>
                        <span class="n">state</span> <span class="o">=</span> <span class="p">[</span><span class="n">stateArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">LU</span><span class="p">,</span> <span class="n">stateArray</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">LU</span><span class="p">,</span> <span class="n">stateArray</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">LU</span><span class="p">,</span> <span class="n">epoch</span><span class="p">]</span>
                        <span class="n">StateHistoryBackward</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

                    <span class="n">StateHistoryBackward</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

                    <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">Y</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">Z</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">StateLine</span> <span class="ow">in</span> <span class="n">StateHistoryBackward</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span> <span class="o">!=</span> <span class="s1">&#39;Journey central body&#39;</span><span class="p">:</span>
                            <span class="kn">import</span> <span class="nn">spiceypy</span>
                            <span class="n">journey_central_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">central_body</span>
                            
                            <span class="k">if</span> <span class="n">journey_central_body</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Mars&#39;</span><span class="p">,</span><span class="s1">&#39;Jupiter&#39;</span><span class="p">,</span><span class="s1">&#39;Uranus&#39;</span><span class="p">,</span><span class="s1">&#39;Neptune&#39;</span><span class="p">,</span><span class="s1">&#39;Pluto&#39;</span><span class="p">]:</span>
                                <span class="n">journey_central_body</span> <span class="o">=</span> <span class="n">journey_central_body</span> <span class="o">+</span> <span class="s1">&#39; Barycenter&#39;</span>

                            <span class="k">if</span> <span class="n">journey_central_body</span> <span class="o">!=</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">:</span>
                                <span class="n">body_state</span><span class="p">,</span> <span class="n">LT</span> <span class="o">=</span> <span class="n">spiceypy</span><span class="o">.</span><span class="n">spkezr</span><span class="p">(</span><span class="n">journey_central_body</span><span class="p">,</span> <span class="n">StateLine</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;J2000&#39;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">)</span>
                            
                                <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                                <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                                <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                                <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                                <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                            <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">for</span> <span class="n">StateLine</span> <span class="ow">in</span> <span class="n">StateHistoryForward</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span> <span class="o">!=</span> <span class="s1">&#39;Journey central body&#39;</span><span class="p">:</span>
                            <span class="kn">import</span> <span class="nn">spiceypy</span>
                            <span class="n">journey_central_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">central_body</span>
                            <span class="k">if</span> <span class="n">journey_central_body</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Mars&#39;</span><span class="p">,</span><span class="s1">&#39;Jupiter&#39;</span><span class="p">,</span><span class="s1">&#39;Uranus&#39;</span><span class="p">,</span><span class="s1">&#39;Neptune&#39;</span><span class="p">,</span><span class="s1">&#39;Pluto&#39;</span><span class="p">]:</span>
                                <span class="n">journey_central_body</span> <span class="o">=</span> <span class="n">journey_central_body</span> <span class="o">+</span> <span class="s1">&#39; Barycenter&#39;</span>
                                
                            <span class="k">if</span> <span class="n">journey_central_body</span> <span class="o">!=</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">:</span>
                                <span class="n">body_state</span><span class="p">,</span> <span class="n">LT</span> <span class="o">=</span> <span class="n">spiceypy</span><span class="o">.</span><span class="n">spkezr</span><span class="p">(</span><span class="n">journey_central_body</span><span class="p">,</span> <span class="n">StateLine</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;J2000&#39;</span><span class="p">,</span> <span class="s2">&quot;NONE&quot;</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">)</span>
                            
                                <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                                <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                                <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                                <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                                <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                            <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

                <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">linestyle</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;FBLTthrust&quot;</span><span class="p">,</span> <span class="s2">&quot;FBLTSthrust&quot;</span><span class="p">,</span> <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">]:</span>
            <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pX</span><span class="p">,</span> <span class="n">pY</span><span class="p">,</span> <span class="n">pZ</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">ShowThrustVectors</span><span class="p">:</span>
                <span class="n">ControlVector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Thrust</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">AvailableThrust</span> <span class="o">*</span> <span class="n">LU</span> <span class="o">*</span> <span class="mf">0.1</span>
                <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">ControlVector</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
                <span class="n">Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">ControlVector</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
                <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">ControlVector</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>

                <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span> <span class="o">!=</span> <span class="s1">&#39;Journey central body&#39;</span><span class="p">:</span>
                    <span class="kn">import</span> <span class="nn">spiceypy</span>
                    <span class="n">journey_central_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">central_body</span>
                    <span class="k">if</span> <span class="n">journey_central_body</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Mars&#39;</span><span class="p">,</span><span class="s1">&#39;Jupiter&#39;</span><span class="p">,</span><span class="s1">&#39;Uranus&#39;</span><span class="p">,</span><span class="s1">&#39;Neptune&#39;</span><span class="p">,</span><span class="s1">&#39;Pluto&#39;</span><span class="p">]:</span>
                        <span class="n">journey_central_body</span> <span class="o">=</span> <span class="n">journey_central_body</span> <span class="o">+</span> <span class="s1">&#39; Barycenter&#39;</span>

                    <span class="n">body_state</span><span class="p">,</span> <span class="n">LT</span> <span class="o">=</span> <span class="n">spiceypy</span><span class="o">.</span><span class="n">spkezr</span><span class="p">(</span><span class="n">journey_central_body</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JulianDate</span> <span class="o">-</span> <span class="mf">2451545.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">86400.0</span><span class="p">,</span> <span class="s1">&#39;J2000&#39;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">)</span>

                    <span class="n">X</span> <span class="o">+=</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">Y</span> <span class="o">+=</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">Z</span> <span class="o">+=</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;violet&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">ShowPropagatedTrajectory</span><span class="p">:</span>
                <span class="n">CenterPointState</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
                <span class="n">CenterPointState</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">)</span> <span class="o">/</span> <span class="n">LU</span>
                <span class="n">CenterPointState</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="n">TU</span>
                <span class="n">CenterPointState</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="n">ScaledThrust</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Thrust</span><span class="p">)</span> <span class="o">*</span> <span class="n">TU</span> <span class="o">*</span> <span class="n">TU</span> <span class="o">/</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mass</span> <span class="o">/</span> <span class="n">LU</span>
                <span class="n">ScaledMdot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MassFlowRate</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mass</span> <span class="o">*</span> <span class="n">TU</span>

                <span class="n">ForwardIntegrateObject</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">EOM</span><span class="o">.</span><span class="n">EOM_inertial_2bodyconstant_thrust</span><span class="p">)</span><span class="o">.</span><span class="n">set_integrator</span><span class="p">(</span><span class="s1">&#39;dop853&#39;</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1.0e-8</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1.0e-8</span><span class="p">)</span>
                <span class="n">ForwardIntegrateObject</span><span class="o">.</span><span class="n">set_initial_value</span><span class="p">(</span><span class="n">CenterPointState</span><span class="p">)</span><span class="o">.</span><span class="n">set_f_params</span><span class="p">(</span><span class="n">ScaledThrust</span><span class="p">,</span> <span class="n">ScaledMdot</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">set_jac_params</span><span class="p">(</span><span class="n">ScaledThrust</span><span class="p">,</span> <span class="n">ScaledMdot</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

                <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">*</span> <span class="mf">86400.0</span> <span class="o">/</span> <span class="n">TU</span> <span class="o">/</span> <span class="mi">10</span>
                <span class="n">StateHistoryForward</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">epoch</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JulianDate</span> <span class="o">-</span> <span class="mf">2451545.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">86400.0</span>
                <span class="k">while</span> <span class="n">ForwardIntegrateObject</span><span class="o">.</span><span class="n">successful</span><span class="p">()</span> <span class="ow">and</span> <span class="n">ForwardIntegrateObject</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">*</span> <span class="mf">86400.0</span> <span class="o">/</span> <span class="n">TU</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">:</span>
                    <span class="n">epoch</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">TU</span>
                    <span class="n">stateArray</span> <span class="o">=</span> <span class="n">ForwardIntegrateObject</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">ForwardIntegrateObject</span><span class="o">.</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span>
                    <span class="n">state</span> <span class="o">=</span> <span class="p">[</span><span class="n">stateArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">LU</span><span class="p">,</span> <span class="n">stateArray</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">LU</span><span class="p">,</span> <span class="n">stateArray</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">LU</span><span class="p">,</span> <span class="n">epoch</span><span class="p">]</span>
                    <span class="n">StateHistoryForward</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

                <span class="n">BackwardIntegrateObject</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">EOM</span><span class="o">.</span><span class="n">EOM_inertial_2bodyconstant_thrust</span><span class="p">)</span><span class="o">.</span><span class="n">set_integrator</span><span class="p">(</span><span class="s1">&#39;dop853&#39;</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1.0e-8</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1.0e-8</span><span class="p">)</span>
                <span class="n">BackwardIntegrateObject</span><span class="o">.</span><span class="n">set_initial_value</span><span class="p">(</span><span class="n">CenterPointState</span><span class="p">)</span><span class="o">.</span><span class="n">set_f_params</span><span class="p">(</span><span class="n">ScaledThrust</span><span class="p">,</span> <span class="n">ScaledMdot</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">set_jac_params</span><span class="p">(</span><span class="n">ScaledThrust</span><span class="p">,</span> <span class="n">ScaledMdot</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

                <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">*</span> <span class="mf">86400.0</span> <span class="o">/</span> <span class="n">TU</span> <span class="o">/</span> <span class="mi">10</span>
                <span class="n">StateHistoryBackward</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">epoch</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JulianDate</span> <span class="o">-</span> <span class="mf">2451545.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">86400.0</span>
                <span class="k">while</span> <span class="n">BackwardIntegrateObject</span><span class="o">.</span><span class="n">successful</span><span class="p">()</span> <span class="ow">and</span> <span class="n">BackwardIntegrateObject</span><span class="o">.</span><span class="n">t</span> <span class="o">&gt;</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">*</span> <span class="mf">86400.0</span> <span class="o">/</span> <span class="n">TU</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">:</span>
                    <span class="n">epoch</span> <span class="o">-=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">TU</span>
                    <span class="n">stateArray</span> <span class="o">=</span> <span class="n">BackwardIntegrateObject</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">BackwardIntegrateObject</span><span class="o">.</span><span class="n">t</span> <span class="o">-</span> <span class="n">dt</span><span class="p">)</span>
                    <span class="n">state</span> <span class="o">=</span> <span class="p">[</span><span class="n">stateArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">LU</span><span class="p">,</span> <span class="n">stateArray</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">LU</span><span class="p">,</span> <span class="n">stateArray</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">LU</span><span class="p">,</span> <span class="n">epoch</span><span class="p">]</span>
                    <span class="n">StateHistoryBackward</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

                <span class="n">StateHistoryBackward</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

                <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">Y</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">Z</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">StateLine</span> <span class="ow">in</span> <span class="n">StateHistoryBackward</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span> <span class="o">!=</span> <span class="s1">&#39;Journey central body&#39;</span><span class="p">:</span>
                        <span class="kn">import</span> <span class="nn">spiceypy</span>
                        <span class="n">journey_central_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">central_body</span>
                        <span class="k">if</span> <span class="n">journey_central_body</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Mars&#39;</span><span class="p">,</span><span class="s1">&#39;Jupiter&#39;</span><span class="p">,</span><span class="s1">&#39;Uranus&#39;</span><span class="p">,</span><span class="s1">&#39;Neptune&#39;</span><span class="p">,</span><span class="s1">&#39;Pluto&#39;</span><span class="p">]:</span>
                            <span class="n">journey_central_body</span> <span class="o">=</span> <span class="n">journey_central_body</span> <span class="o">+</span> <span class="s1">&#39; Barycenter&#39;</span>
                            
                        <span class="k">if</span> <span class="n">journey_central_body</span> <span class="o">!=</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">:</span>
                            <span class="n">body_state</span><span class="p">,</span> <span class="n">LT</span> <span class="o">=</span> <span class="n">spiceypy</span><span class="o">.</span><span class="n">spkezr</span><span class="p">(</span><span class="n">journey_central_body</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JulianDate</span> <span class="o">-</span> <span class="mf">2451545.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">86400.0</span> <span class="o">+</span> <span class="n">StateLine</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;J2000&#39;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">)</span>
                            
                            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                            <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                            <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">StateLine</span> <span class="ow">in</span> <span class="n">StateHistoryForward</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span> <span class="o">!=</span> <span class="s1">&#39;Journey central body&#39;</span><span class="p">:</span>
                        <span class="kn">import</span> <span class="nn">spiceypy</span>
                        <span class="n">journey_central_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">central_body</span>
                        <span class="k">if</span> <span class="n">journey_central_body</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Mars&#39;</span><span class="p">,</span><span class="s1">&#39;Jupiter&#39;</span><span class="p">,</span><span class="s1">&#39;Uranus&#39;</span><span class="p">,</span><span class="s1">&#39;Neptune&#39;</span><span class="p">,</span><span class="s1">&#39;Pluto&#39;</span><span class="p">]:</span>
                            <span class="n">journey_central_body</span> <span class="o">=</span> <span class="n">journey_central_body</span> <span class="o">+</span> <span class="s1">&#39; Barycenter&#39;</span>

                        <span class="k">if</span> <span class="n">journey_central_body</span> <span class="o">!=</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">:</span>
                            <span class="n">body_state</span><span class="p">,</span> <span class="n">LT</span> <span class="o">=</span> <span class="n">spiceypy</span><span class="o">.</span><span class="n">spkezr</span><span class="p">(</span><span class="n">journey_central_body</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JulianDate</span> <span class="o">-</span> <span class="mf">2451545.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">86400.0</span> <span class="o">+</span> <span class="n">StateLine</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;J2000&#39;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">)</span>
                            
                            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                            <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                            <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

                <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s2">&quot;insertion&quot;</span><span class="p">:</span>
            <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pX</span><span class="p">,</span> <span class="n">pY</span><span class="p">,</span> <span class="n">pZ</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s2">&quot;LT_rndzvs&quot;</span><span class="p">:</span>
            <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pX</span><span class="p">,</span> <span class="n">pY</span><span class="p">,</span> <span class="n">pZ</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s2">&quot;intercept&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;momtransfer&#39;</span><span class="p">:</span>
            <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pX</span><span class="p">,</span> <span class="n">pY</span><span class="p">,</span> <span class="n">pZ</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s2">&quot;rendezvous&quot;</span><span class="p">:</span>
            <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pX</span><span class="p">,</span> <span class="n">pY</span><span class="p">,</span> <span class="n">pZ</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s2">&quot;match-vinf&quot;</span><span class="p">:</span>
            <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pX</span><span class="p">,</span> <span class="n">pY</span><span class="p">,</span> <span class="n">pZ</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s2">&quot;match_point&quot;</span><span class="p">:</span>
            <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pX</span><span class="p">,</span> <span class="n">pY</span><span class="p">,</span> <span class="n">pZ</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
            <span class="n">BeforeMatchPoint</span> <span class="o">=</span> <span class="kc">False</span>


        <span class="n">nonPlottableEvents</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;zeroflyby&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;coast&#39;</span><span class="p">,</span> 
                              <span class="s1">&#39;nav-coast&#39;</span><span class="p">,</span> 
                              <span class="s1">&#39;Scoast&#39;</span><span class="p">,</span> 
                              <span class="s1">&#39;force-coast&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> 
                              <span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;match_point&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;waiting&#39;</span><span class="p">,</span> 
                              <span class="s1">&#39;LT_spiral&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;TCM&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">PlotOptions</span><span class="o">.</span><span class="n">LabelEvents</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="n">nonPlottableEvents</span><span class="p">))</span> <span class="ow">or</span> <span class="n">CustomLabel</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EventNumber</span><span class="p">,</span> <span class="n">CustomLabel</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LabelEvent</span><span class="p">(</span><span class="n">GraphicsObject</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="p">,</span> <span class="n">CustomLabel</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">BeforeMatchPoint</span></div>


<div class="viewcode-block" id="MissionEvent.LabelEvent">
<a class="viewcode-back" href="../PyEMTG/MissionEvent.html#MissionEvent.MissionEvent.LabelEvent">[docs]</a>
    <span class="k">def</span> <span class="nf">LabelEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">GraphicsObject</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="p">,</span> <span class="n">labelString</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>        
        <span class="kn">import</span> <span class="nn">matplotlib</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
        <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
        <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">proj3d</span>

        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">labelString</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">ShowTextDescriptions</span><span class="p">:</span>
                <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span>
                <span class="k">if</span> <span class="n">EventTypeFormatted</span> <span class="o">==</span> <span class="s1">&#39;upwr_flyby&#39;</span><span class="p">:</span>
                    <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="s1">&#39;unpowered flyby&#39;</span>
                <span class="k">elif</span> <span class="n">EventTypeFormatted</span> <span class="o">==</span> <span class="s1">&#39;pwr_flyby&#39;</span><span class="p">:</span>
                    <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="s1">&#39;powered flyby&#39;</span>
                <span class="k">elif</span> <span class="n">EventTypeFormatted</span> <span class="o">==</span> <span class="s1">&#39;chem_burn&#39;</span><span class="p">:</span>
                    <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="s1">&#39;chemical burn&#39;</span>
                <span class="k">elif</span> <span class="n">EventTypeFormatted</span> <span class="o">==</span> <span class="s1">&#39;LT_rndzvs&#39;</span><span class="p">:</span>
                    <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="s1">&#39;rendezvous&#39;</span>
                <span class="k">elif</span> <span class="n">EventTypeFormatted</span> <span class="o">==</span> <span class="s1">&#39;begin_spiral&#39;</span><span class="p">:</span>
                    <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="s1">&#39;begin spiral&#39;</span>
                <span class="k">elif</span> <span class="n">EventTypeFormatted</span> <span class="o">==</span> <span class="s1">&#39;end_spiral&#39;</span><span class="p">:</span>
                    <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="s1">&#39;end spiral&#39;</span>
                <span class="k">elif</span> <span class="n">EventTypeFormatted</span> <span class="o">==</span> <span class="s1">&#39;mission_end&#39;</span><span class="p">:</span>
                    <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="s1">&#39;end of mission&#39;</span>
                <span class="k">elif</span> <span class="n">EventTypeFormatted</span> <span class="o">==</span> <span class="s1">&#39;momtransfer&#39;</span><span class="p">:</span>
                    <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="s1">&#39;momentum transfer&#39;</span>

                <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">NumberEventLabels</span><span class="p">:</span>
                    <span class="n">EventNumber</span> <span class="o">=</span> <span class="s1">&#39;Event # &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PlotOptions</span><span class="o">.</span><span class="n">EventCounter</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">EventNumber</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

                <span class="n">description</span> <span class="o">=</span> <span class="n">EventNumber</span> <span class="o">+</span> <span class="n">EventTypeFormatted</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Location</span>
        
                <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">DisplayEventDates</span><span class="p">:</span>
                    <span class="n">description</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">GregorianDate</span>
        
                <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">DisplayEventSpecs</span><span class="p">:</span>
                    <span class="c1">#for launches a C3 and DLA are needed</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;launch&#39;</span><span class="p">:</span>
                        <span class="n">description</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">$C_3$ = &#39;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{0:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; $km^2/s^2$&#39;</span>
                        <span class="c1">#add the LV to the description?</span>
                        <span class="n">description</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">DLA = &#39;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{0:.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Declination</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;$^{\circ}$&#39;</span>

                    <span class="c1">#for non-launch departures only the C3 is needed</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;departure&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">C3</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">description</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">$C_3$ = &#39;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{0:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; $km^2/s^2$&#39;</span>

                    <span class="c1">#for other events, output v-infinity and DLA</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;upwr_flyby&#39;</span><span class="p">,</span> <span class="s1">&#39;pwr_flyby&#39;</span><span class="p">,</span> <span class="s1">&#39;intercept&#39;</span><span class="p">,</span> <span class="s1">&#39;interface&#39;</span><span class="p">,</span> <span class="s1">&#39;insertion&#39;</span><span class="p">,</span> <span class="s1">&#39;momtransfer&#39;</span><span class="p">]:</span>
                        <span class="n">description</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">$v_\infty$ = &#39;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{0:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; $km/s$&#39;</span>
                        <span class="n">description</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">DEC = &#39;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{0:.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Declination</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;$^{\circ}$&#39;</span>

                    <span class="c1">#for flybys, altitude should be outputed</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;upwr_flyby&#39;</span><span class="p">,</span> <span class="s1">&#39;pwr_flyby&#39;</span><span class="p">,</span> <span class="s1">&#39;periapse&#39;</span><span class="p">]:</span>
                        <span class="n">description</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">altitude = &#39;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{0:.0f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Altitude</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; $km$&#39;</span>



                    <span class="c1">#for propulsive events, a deltaV is needed</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;departure&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;pwr_flyby&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;insertion&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;chem_burn&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;rendezvous&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">DVmagorThrottle</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                            <span class="n">description</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">$\Delta v$ = &#39;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{0:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DVmagorThrottle</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; $km/s$&#39;</span>

                    <span class="c1">#always append the spacecraft Mass</span>
                    <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">DisplayEventMass</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mass</span> <span class="o">&lt;</span> <span class="mf">1.0e+5</span><span class="p">:</span>
                            <span class="n">description</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">m = &#39;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{0:.0f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Mass</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; $kg$&#39;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">description</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">m = &#39;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{0:.4e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Mass</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; $kg$&#39;</span>

                    <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">DisplayArrivalPhaseAngle</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;intercept&#39;</span><span class="p">:</span>
                        <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
                        <span class="n">V</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DeltaVorThrustVectorControl</span>
                        <span class="n">r</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="n">v</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">PhaseAngle</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
                            <span class="n">description</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\beta $&#39;</span> <span class="o">+</span> <span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{0:.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PhaseAngle</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; degrees&#39;</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bad velocity vector while calculating phase angle, event&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EventNumber</span><span class="p">))</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">description</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">PlotOptions</span><span class="o">.</span><span class="n">EventCounter</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="n">labelString</span>

        <span class="c1">#draw the text</span>
        <span class="c1">#note, do not draw anything for chemical burns below 10 m/s</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s2">&quot;chem_burn&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">DVmagorThrottle</span> <span class="o">&lt;</span> <span class="mf">0.0001</span><span class="p">):</span>
            <span class="n">x2D</span><span class="p">,</span> <span class="n">y2D</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">proj3d</span><span class="o">.</span><span class="n">proj_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">get_proj</span><span class="p">())</span>
            
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">ShowTextDescriptions</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">eventlabel</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="n">xycoords</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2D</span><span class="p">,</span> <span class="n">y2D</span><span class="p">),</span> <span class="n">xytext</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="p">(</span><span class="n">PlotOptions</span><span class="o">.</span><span class="n">EventCounter</span> <span class="o">+</span> <span class="mi">20</span><span class="p">)),</span> <span class="n">textcoords</span> <span class="o">=</span> <span class="s1">&#39;offset points&#39;</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                <span class="c1">#self.eventlabel = plt.annotate(description, xycoords = &#39;data&#39;, xy = (self.SpacecraftState[0],self.SpacecraftState[1]), xytext = (20, (PlotOptions.EventCounter + 20)), textcoords = &#39;offset points&#39;, ha = &#39;left&#39;, va = &#39;bottom&#39;,</span>
                                               <span class="n">bbox</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span> <span class="o">=</span> <span class="s1">&#39;round,pad=0.5&#39;</span><span class="p">,</span> <span class="n">fc</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">arrowprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span>
                                               <span class="n">connectionstyle</span> <span class="o">=</span> <span class="s1">&#39;arc3,rad=0&#39;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">PlotOptions</span><span class="o">.</span><span class="n">FontSize</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">)</span> <span class="c1"># changed to usurp drag-fu</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">eventlabel</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="n">xycoords</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2D</span><span class="p">,</span> <span class="n">y2D</span><span class="p">),</span> <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                                               <span class="n">bbox</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span> <span class="o">=</span> <span class="s1">&#39;round,pad=0.5&#39;</span><span class="p">,</span> <span class="n">fc</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">arrowprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span>
                                               <span class="n">connectionstyle</span> <span class="o">=</span> <span class="s1">&#39;arc3,rad=0&#39;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">PlotOptions</span><span class="o">.</span><span class="n">FontSize</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">)</span> <span class="c1"># changed to usurp drag-fu</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">AnnotationHelper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eventlabel</span><span class="o">.</span><span class="n">draggable</span><span class="p">(</span><span class="n">use_blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pcid</span> <span class="o">=</span> <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;button_press_event&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ClickAnnotation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rcid</span> <span class="o">=</span> <span class="n">GraphicsObject</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;button_release_event&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReleaseAnnotation</span><span class="p">)</span>

            <span class="c1">#update the event counter only if the event is printable</span>
            <span class="n">PlotOptions</span><span class="o">.</span><span class="n">EventCounter</span> <span class="o">+=</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="MissionEvent.UpdateLabelPosition">
<a class="viewcode-back" href="../PyEMTG/MissionEvent.html#MissionEvent.MissionEvent.UpdateLabelPosition">[docs]</a>
    <span class="k">def</span> <span class="nf">UpdateLabelPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Figure</span><span class="p">,</span> <span class="n">Axes</span><span class="p">):</span>        
        <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">proj3d</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eventlabel</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Moving label #&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EventNumber</span><span class="p">))</span>
            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">proj3d</span><span class="o">.</span><span class="n">proj_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">Axes</span><span class="o">.</span><span class="n">get_proj</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eventlabel</span><span class="o">.</span><span class="n">xy</span> <span class="o">=</span> <span class="n">x2</span><span class="p">,</span><span class="n">y2</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">eventlabel</span><span class="o">.</span><span class="n">update_positions</span><span class="p">(</span><span class="n">Figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">renderer</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Figure.canvas.renderer is not initialized. Don</span><span class="se">\&#39;</span><span class="s1">t worry, everything will probably work fine. Don</span><span class="se">\&#39;</span><span class="s1">t you love bubbles?&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="MissionEvent.ClickAnnotation">
<a class="viewcode-back" href="../PyEMTG/MissionEvent.html#MissionEvent.MissionEvent.ClickAnnotation">[docs]</a>
    <span class="k">def</span> <span class="nf">ClickAnnotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">inaxes</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eventlabel</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="n">MissionEvent</span><span class="o">.</span><span class="n">lock</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">contains</span><span class="p">,</span> <span class="n">attrd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eventlabel</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">contains</span><span class="p">:</span> <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eventlabel</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">disable_mouse_rotation</span><span class="p">()</span>
        <span class="n">MissionEvent</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="MissionEvent.ReleaseAnnotation">
<a class="viewcode-back" href="../PyEMTG/MissionEvent.html#MissionEvent.MissionEvent.ReleaseAnnotation">[docs]</a>
    <span class="k">def</span> <span class="nf">ReleaseAnnotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">MissionEvent</span><span class="o">.</span><span class="n">lock</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">MissionEvent</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">inaxes</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eventlabel</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span> <span class="k">return</span>

        <span class="n">contains</span><span class="p">,</span> <span class="n">attrd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eventlabel</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">contains</span><span class="p">:</span> <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eventlabel</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">mouse_init</span><span class="p">()</span></div>


<div class="viewcode-block" id="MissionEvent.AutoTableLine">
<a class="viewcode-back" href="../PyEMTG/MissionEvent.html#MissionEvent.MissionEvent.AutoTableLine">[docs]</a>
    <span class="k">def</span> <span class="nf">AutoTableLine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">TableFile</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="p">,</span> <span class="n">skipNext</span><span class="p">):</span>
        <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span>
        <span class="n">LocationFormatted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Location</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">EventTypeFormatted</span> <span class="o">==</span> <span class="s1">&#39;upwr_flyby&#39;</span><span class="p">:</span>
            <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="s1">&#39;unpowered flyby&#39;</span>
        <span class="k">elif</span> <span class="n">EventTypeFormatted</span> <span class="o">==</span> <span class="s1">&#39;pwr_flyby&#39;</span><span class="p">:</span>
            <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="s1">&#39;powered flyby&#39;</span>
        <span class="k">elif</span> <span class="n">EventTypeFormatted</span> <span class="o">==</span> <span class="s1">&#39;chem_burn&#39;</span><span class="p">:</span>
            <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="s1">&#39;chemical burn&#39;</span>
        <span class="k">elif</span> <span class="n">EventTypeFormatted</span> <span class="o">==</span> <span class="s1">&#39;LT_rndzvs&#39;</span><span class="p">:</span>
            <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="s1">&#39;rendezvous&#39;</span>
        <span class="k">elif</span> <span class="n">EventTypeFormatted</span> <span class="o">==</span> <span class="s1">&#39;begin_spiral&#39;</span><span class="p">:</span>
            <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="s1">&#39;begin spiral&#39;</span>
        <span class="k">elif</span> <span class="n">EventTypeFormatted</span> <span class="o">==</span> <span class="s1">&#39;end_spiral&#39;</span><span class="p">:</span>
            <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="s1">&#39;end spiral&#39;</span>
        <span class="k">elif</span> <span class="n">EventTypeFormatted</span> <span class="o">==</span> <span class="s1">&#39;mission_end&#39;</span><span class="p">:</span>
            <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="s1">&#39;end of mission&#39;</span>

        <span class="n">plotMe</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span>  <span class="n">skipNext</span>\
            <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;chem_burn&#39;</span><span class="p">,</span> <span class="s1">&#39;TCM&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">DVmagorThrottle</span> <span class="o">&lt;</span> <span class="mf">0.00001</span><span class="p">)</span>\
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;zeroflyby&#39;</span><span class="p">,</span><span class="s1">&#39;coast&#39;</span><span class="p">,</span><span class="s1">&#39;nav-coast&#39;</span><span class="p">,</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span><span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span><span class="s1">&#39;match_point&#39;</span><span class="p">,</span><span class="s1">&#39;force-coast&#39;</span><span class="p">]</span>\
            <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;TCM&#39;</span> <span class="ow">and</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">AutoTableTCMcolumn</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">plotMe</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="s2">&quot; BE&quot;</span> <span class="ow">in</span> <span class="n">LocationFormatted</span><span class="p">:</span>
            <span class="n">plotMe</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">skipNext</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">EventTypeFormatted</span> <span class="o">==</span> <span class="s1">&#39;periapse&#39;</span><span class="p">:</span>
            <span class="n">EventTypeFormatted</span> <span class="o">=</span> <span class="s1">&#39;unpowered flyby&#39;</span>
            <span class="n">LocationFormatted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">central_body</span>
            <span class="n">skipNext</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">skipNext</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1">#columns are date, event type, event location, vinfinity, deltav, altitude, mass (if applicable)</span>
        <span class="k">if</span> <span class="n">plotMe</span><span class="p">:</span>
            <span class="n">TableFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;       &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">PlotOptions</span><span class="o">.</span><span class="n">EventCounter</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">GregorianDate</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="n">EventTypeFormatted</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="n">LocationFormatted</span> <span class="o">+</span> <span class="s1">&#39;&amp;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">EventTypeFormatted</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;launch&#39;</span><span class="p">,</span><span class="s1">&#39;unpowered flyby&#39;</span><span class="p">,</span><span class="s1">&#39;powered flyby&#39;</span><span class="p">,</span><span class="s1">&#39;rendezvous&#39;</span><span class="p">,</span><span class="s1">&#39;intercept&#39;</span><span class="p">,</span><span class="s1">&#39;interface&#39;</span><span class="p">,</span><span class="s1">&#39;insertion&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">C3</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">TableFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C3</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">TableFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">AutoTableDeltavColumn</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;chem_burn&#39;</span><span class="p">,</span><span class="s1">&#39;rendezvous&#39;</span><span class="p">,</span><span class="s1">&#39;pwr_flyby&#39;</span><span class="p">,</span><span class="s1">&#39;insertion&#39;</span><span class="p">,</span><span class="s1">&#39;TCM&#39;</span><span class="p">,</span><span class="s1">&#39;departure&#39;</span><span class="p">]:</span>
                    <span class="n">TableFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">{0:.5f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DVmagorThrottle</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
                    <span class="n">TableFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">{0:.0f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Isp</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">TableFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
                    <span class="n">TableFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
                            
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">AutoTableAltitudeColumn</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">EventTypeFormatted</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;unpowered flyby&#39;</span><span class="p">,</span><span class="s1">&#39;powered flyby&#39;</span><span class="p">]:</span>
                    <span class="n">TableFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">{0:.0f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Altitude</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">TableFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">DisplayEventMass</span><span class="p">:</span>
                <span class="n">TableFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="s2">&quot;</span><span class="si">{0:.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Mass</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">DisplayArrivalPhaseAngle</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;intercept&#39;</span><span class="p">:</span>
                    <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
                    <span class="n">V</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DeltaVorThrustVectorControl</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="n">PhaseAngle</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
                    <span class="n">TableFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PhaseAngle</span><span class="p">))</span>

            <span class="n">TableFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\\\\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">PlotOptions</span><span class="o">.</span><span class="n">EventCounter</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">skipNext</span></div>


<div class="viewcode-block" id="MissionEvent.getLaunchHyperbolicCoordinates">
<a class="viewcode-back" href="../PyEMTG/MissionEvent.html#MissionEvent.MissionEvent.getLaunchHyperbolicCoordinates">[docs]</a>
    <span class="k">def</span> <span class="nf">getLaunchHyperbolicCoordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">atan2</span><span class="p">,</span> <span class="n">asin</span><span class="p">,</span> <span class="n">pi</span>
        <span class="n">rVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">vVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
        <span class="n">hVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">rVec</span><span class="p">,</span> <span class="n">vVec</span><span class="p">)</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mu</span>
        
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">rVec</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vVec</span><span class="p">)</span>

        <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">hVec</span><span class="p">)</span>

        <span class="c1">#hyperbolic C3 may be different from what is recorded in the event&#39;s C3 entry, or you may be computing C3 from a line that doesn&#39;t have a C3 entry</span>
        <span class="c1">#we&#39;re going to return it as an arguement rather than change the event&#39;s object data`</span>
        <span class="n">C3</span> <span class="o">=</span> <span class="n">v</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">/</span> <span class="n">r</span>

        <span class="c1">#now we need to find the v-infinity vector</span>
        <span class="c1">#first we need the eccentricity vector</span>
        <span class="n">eVec</span> <span class="o">=</span> <span class="p">((</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">/</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="n">rVec</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rVec</span><span class="p">,</span> <span class="n">vVec</span><span class="p">)</span> <span class="o">*</span> <span class="n">vVec</span><span class="p">)</span> <span class="o">/</span> <span class="n">mu</span>

        <span class="c1">#outgoing asymptote unit vector</span>
        <span class="n">sHat</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">C3</span> <span class="o">*</span> <span class="p">(</span><span class="n">h</span> <span class="o">/</span> <span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">C3</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">hVec</span><span class="p">,</span> <span class="n">eVec</span><span class="p">)</span> <span class="o">-</span> <span class="n">eVec</span><span class="p">)</span>

        <span class="c1">#RLA and DLA</span>
        <span class="n">RLA</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">sHat</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sHat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">pi</span>

        <span class="n">DLA</span> <span class="o">=</span> <span class="n">asin</span><span class="p">(</span><span class="n">sHat</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">pi</span>

        <span class="k">return</span> <span class="n">C3</span><span class="p">,</span> <span class="n">RLA</span><span class="p">,</span> <span class="n">DLA</span></div>
</div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">EMTG python</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../PyEMTG/index.html">PyEMTG documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PEATSA/index.html">PEATSA documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OptionsOverhaul/index.html">OptionsOverhaul documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Jacob Englander, Donald Ellison, Jeremy Knittel, Noble Hatten.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
    </div>

    

    
  </body>
</html>