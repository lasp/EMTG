
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>inputValidators &#8212; EMTG python  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for inputValidators</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">inputValidators.py</span>
<span class="sd">========================</span>
<span class="sd">This file contains various classes and functions to support input validation for wx.TextCtrl inputs. It includes</span>
<span class="sd">NumberRangeValidator, FilePathValidator, ListFormatValidator, and AlphaNumericFileValidator.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">wx</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">ParseMathString</span> <span class="kn">import</span> <span class="n">ParseMathString</span>


<div class="viewcode-block" id="NumberRangeValidator"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.NumberRangeValidator">[docs]</a><span class="k">class</span> <span class="nc">NumberRangeValidator</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Validator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to restrict an input to numeric characters, and prevents numbers outside the given range from being entered.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">isInt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the NumberRangeValidator class</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rng : list[2]</span>
<span class="sd">            A two element list containing the lower bound (inclusive) and upper bound (exclusive) of the input.</span>
<span class="sd">        isInt : bool</span>
<span class="sd">            If true, the input will only contain integer values. If false it will contain floating point values.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NumberRangeValidator.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NumberRangeValidator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">isInt</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validChars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SetRange</span><span class="p">(</span><span class="n">rng</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetIsInt</span><span class="p">(</span><span class="n">isInt</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetWindow</span><span class="p">()</span>  <span class="c1"># this usually returns None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nondigitCodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">WXK_BACK</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_DELETE</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_LEFT</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_RIGHT</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_C</span><span class="p">,</span>
                              <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_V</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_X</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_Z</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_Y</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sign</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hasDialog</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neverFocused</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># event bindings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnChar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_KILL_FOCUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnKillFocus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_SET_FOCUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnSetFocus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT_PASTE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnTextPaste</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_IDLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnIdle</span><span class="p">)</span>

    <span class="c1"># setters</span>
<div class="viewcode-block" id="NumberRangeValidator.SetRange"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.NumberRangeValidator.SetRange">[docs]</a>    <span class="k">def</span> <span class="nf">SetRange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rng</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setter for the range attribute, should always be used to set the range outside of the constructor</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rng : list[2]</span>
<span class="sd">            A two element list containing the lower bound (inclusive) and upper bound (exclusive) of the input.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="n">rng</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-inf&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;inf&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
        <span class="c1"># if only negative numbers are allowed, make sure we have a negative sign</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span></div>

<div class="viewcode-block" id="NumberRangeValidator.SetIsInt"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.NumberRangeValidator.SetIsInt">[docs]</a>    <span class="k">def</span> <span class="nf">SetIsInt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isInt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setter for the isInt attribute, should always be used to set isInt outside of the constructor</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        isInt : bool</span>
<span class="sd">            If true, the input will only contain integer values. If false it will contain floating point values.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">isInt</span> <span class="o">=</span> <span class="n">isInt</span></div>

    <span class="c1"># required methods from base class</span>
<div class="viewcode-block" id="NumberRangeValidator.Clone"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.NumberRangeValidator.Clone">[docs]</a>    <span class="k">def</span> <span class="nf">Clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">NumberRangeValidator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">isInt</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumberRangeValidator.Validate"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.NumberRangeValidator.Validate">[docs]</a>    <span class="k">def</span> <span class="nf">Validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="NumberRangeValidator.TransferToWindow"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.NumberRangeValidator.TransferToWindow">[docs]</a>    <span class="k">def</span> <span class="nf">TransferToWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="NumberRangeValidator.TransferFromWindow"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.NumberRangeValidator.TransferFromWindow">[docs]</a>    <span class="k">def</span> <span class="nf">TransferFromWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="c1"># utility methods</span>
<div class="viewcode-block" id="NumberRangeValidator.checkBounds"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.NumberRangeValidator.checkBounds">[docs]</a>    <span class="k">def</span> <span class="nf">checkBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">again</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether the given text is a valid number, and whether that number is within the range</span>

<span class="sd">        - If the value is not a valid number, but could be with additional input the return value is (True, None)</span>
<span class="sd">        - If the value contains characters that do not form a valid number the return value is (False, None)</span>
<span class="sd">        - If the value is a valid number but is not in the range the return value is (False, value)</span>
<span class="sd">        - If the value is a valid number and is in the range the return value is (True, value)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        txt : string</span>
<span class="sd">            The string to be checked against the range</span>
<span class="sd">        again : bool, defaults to True</span>
<span class="sd">            Whether the string should be checked again with the last character removed, useful for checking a value like &quot;1e&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple(bool,float).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># case where we have characters that &quot;could&quot; result in a valid number, but don&#39;t right now</span>
            <span class="k">if</span> <span class="n">txt</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span> <span class="ow">or</span> <span class="n">txt</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetForegroundColour</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">Refresh</span><span class="p">()</span>
                <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">letter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">validChars</span> <span class="ow">and</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">txt</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="c1"># try to convert the text to a number</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>

            <span class="c1"># make sure it&#39;s in the range</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetForegroundColour</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">Refresh</span><span class="p">()</span>
                <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetForegroundColour</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">Refresh</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># this means we don&#39;t have a valid number</span>
            <span class="c1"># but it could be a valid number with &quot;e&quot; or &quot;.&quot; on the end</span>
            <span class="c1"># so recheck ignoring the last character</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">txt</span> <span class="o">==</span> <span class="s2">&quot;--&quot;</span> <span class="ow">and</span> <span class="n">again</span><span class="p">:</span>  <span class="c1"># ignore false positive edge case</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBounds</span><span class="p">(</span><span class="n">txt</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div>

    <span class="c1"># event handlers</span>
<div class="viewcode-block" id="NumberRangeValidator.OnChar"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.NumberRangeValidator.OnChar">[docs]</a>    <span class="k">def</span> <span class="nf">OnChar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_CHAR event, fires before a character shows up in the input</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.KeyEvent</span>
<span class="sd">            Contains information about the key press that triggered this event</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get some useful info about the input&#39;s state</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetKeyCode</span><span class="p">()</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="n">spot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetInsertionPoint</span><span class="p">()</span>

        <span class="c1"># handle typing a negative sign with default text showing (e.g., &quot;-0&quot; -&gt; &quot;-&quot;)</span>
        <span class="k">if</span> <span class="n">text</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">and</span> <span class="n">code</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># handle typing a character that could occur in the middle of a number</span>
        <span class="k">if</span> <span class="nb">chr</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">validChars</span> <span class="ow">and</span> <span class="n">text</span> <span class="o">!=</span> <span class="s2">&quot;-&quot;</span> <span class="ow">and</span> <span class="n">text</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">spot</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># handle typing numbers and &quot;-&quot; when default text is not showing</span>
        <span class="k">if</span> <span class="nb">chr</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="ow">or</span> <span class="n">code</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>

            <span class="c1"># get what the new text would be after the character is typed</span>
            <span class="n">textAfterUpdate</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

            <span class="k">if</span> <span class="n">text</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">and</span> <span class="n">spot</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">textAfterUpdate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sign</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">textAfterUpdate</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">spot</span><span class="p">]</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">spot</span><span class="p">:]</span>

            <span class="c1"># check if the new text would be valid</span>
            <span class="n">good</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBounds</span><span class="p">(</span><span class="n">textAfterUpdate</span><span class="p">)</span>

            <span class="c1"># if the character would or could probably produce a valid number, let it through</span>
            <span class="k">if</span> <span class="n">good</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">char</span> <span class="ow">in</span> <span class="n">textAfterUpdate</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">validChars</span><span class="p">):</span>
                    <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
                <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">):</span>  <span class="c1"># handle cases where the numerical value is just the default text</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetInsertionPoint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">text</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">char</span> <span class="ow">in</span> <span class="n">text</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">validChars</span><span class="p">)</span> <span class="ow">or</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">return</span>

        <span class="c1"># get the selected characters to use with backspace logic</span>
        <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">charsToBeDeleted</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">sel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># if we&#39;re before any text in the input just do nothing</span>
        <span class="k">if</span> <span class="n">spot</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">charsToBeDeleted</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">code</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_BACK</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># if doing a backspace would leave the input without a valid number, switch to the default text</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">-</span> <span class="n">charsToBeDeleted</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span> <span class="ow">and</span> <span class="n">code</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_BACK</span><span class="p">:</span>
            <span class="c1"># for updating color</span>
            <span class="n">textAfterUpdate</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

            <span class="k">if</span> <span class="n">charsToBeDeleted</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">textAfterUpdate</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">spot</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">spot</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">textAfterUpdate</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">sel</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">checkBounds</span><span class="p">(</span><span class="n">textAfterUpdate</span><span class="p">)</span>

            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span>
        <span class="c1"># otherwise, make sure the remaining text will still be a valid number</span>
        <span class="k">elif</span> <span class="n">code</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_BACK</span><span class="p">:</span>
            <span class="c1"># go through a similar process as adding a character, but we&#39;re removing one this time</span>
            <span class="n">textAfterUpdate</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

            <span class="k">if</span> <span class="n">charsToBeDeleted</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">textAfterUpdate</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">spot</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">spot</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">textAfterUpdate</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">sel</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span>

            <span class="n">good</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBounds</span><span class="p">(</span><span class="n">textAfterUpdate</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">good</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">and</span> <span class="p">(</span><span class="n">val</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="k">return</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>

            <span class="k">return</span>

        <span class="c1"># otherwise check if the &quot;character&quot; is some other control sequence (e.g., CTRL-Z)</span>
        <span class="k">if</span> <span class="n">code</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nondigitCodes</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># if we got here it&#39;s probably a letter or punctuation, so don&#39;t let it through</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="NumberRangeValidator.OnText"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.NumberRangeValidator.OnText">[docs]</a>    <span class="k">def</span> <span class="nf">OnText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_TEXT event, fires after a character shows up in the input</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.CommandEvent</span>
<span class="sd">            Contains information about text contained within the input when this event was fired</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># this fires when update() is called when the window loads, so in case input is still None, set it again</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetWindow</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
                <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetParent</span><span class="p">()</span><span class="o">.</span><span class="n">hasValidatorDialog</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># get the new text</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetString</span><span class="p">()</span>

        <span class="c1"># otherwise check the new text</span>
        <span class="n">good</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBounds</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="c1"># adds formatting for float or int</span>
        <span class="c1"># only fires when the input is not in focus so it doesn&#39;t mess up the user typing</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">HasFocus</span><span class="p">():</span>
            <span class="c1"># if the value is numerically equivalent to the default, set the value of the input to default so it can be formatted below</span>
            <span class="k">if</span> <span class="n">good</span> <span class="ow">and</span> <span class="n">val</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
            <span class="c1"># if it&#39;s not a valid number, set the text to be red (probably set incorrectly elsewhere in code)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">good</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">neverFocused</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetForegroundColour</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">Refresh</span><span class="p">()</span>

            <span class="c1"># add proper formatting</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isInt</span><span class="p">:</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sign</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()))))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())))</span></div>

<div class="viewcode-block" id="NumberRangeValidator.OnSetFocus"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.NumberRangeValidator.OnSetFocus">[docs]</a>    <span class="k">def</span> <span class="nf">OnSetFocus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_SET_FOCUS event, fires before an input receives focus</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.FocusEvent</span>
<span class="sd">            Contains information about the input gaining focus</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neverFocused</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># if the OnText handler wasn&#39;t used, make sure the input is actually set</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetWindow</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
                <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetParent</span><span class="p">()</span><span class="o">.</span><span class="n">hasValidatorDialog</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">good</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBounds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>

        <span class="c1"># adds formatting for float or int</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isInt</span><span class="p">:</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sign</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()))))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())))</span>

        <span class="c1"># always skip focus events</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span></div>

<div class="viewcode-block" id="NumberRangeValidator.OnKillFocus"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.NumberRangeValidator.OnKillFocus">[docs]</a>    <span class="k">def</span> <span class="nf">OnKillFocus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_KILL_FOCUS event, fires before an input leaves focus</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.FocusEvent</span>
<span class="sd">            Contains information about the input losing focus</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>

        <span class="c1"># if the user left nothing or just a &quot;-&quot; in the input, set it to the default so there&#39;s no errors</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">text</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">text</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>

        <span class="n">good</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBounds</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="c1"># make sure the text box contains a properly formatted number otherwise</span>
        <span class="k">if</span> <span class="n">good</span> <span class="ow">and</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span> <span class="ow">or</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>

        <span class="c1"># do a regex match to make sure the &quot;e&quot; and &quot;.&quot; characters were used properly</span>
        <span class="c1"># while keeping at least some of the input if they weren&#39;t</span>
        <span class="n">finalTest</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^[\-]?[0-9]+(\.[0-9]+)?(e[\-]?[0-9]+(?!\.))?((\*\*)|[\-\+\*\/\^])?[\-]?[0-9]*(\.[0-9]+)?(e[\-]?[0-9]+)?&quot;</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">finalTest</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>
        
        <span class="n">success</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">ParseMathString</span><span class="p">(</span><span class="n">finalTest</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="c1"># the string is probably only invalid mathmatically</span>
            <span class="n">cleanup</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\-?[0-9]+&quot;</span><span class="p">,</span> <span class="n">finalTest</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">cleanup</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cleanup</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
        
        
        <span class="n">num</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isInt</span><span class="p">:</span>
            <span class="n">num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="c1"># check again after processing math</span>
        <span class="n">good</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBounds</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

        <span class="c1"># if the number is not valid, set flags so the popup windows shows if necessary</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">good</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">grandparent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetParent</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">grandparent</span><span class="o">.</span><span class="n">hasValidatorDialog</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span><span class="p">:</span>
                <span class="n">grandparent</span><span class="o">.</span><span class="n">hasValidatorDialog</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hasDialog</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetForegroundColour</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">Refresh</span><span class="p">()</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetForegroundColour</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">Refresh</span><span class="p">()</span>

        <span class="c1"># always skip focus events</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span></div>

<div class="viewcode-block" id="NumberRangeValidator.OnTextPaste"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.NumberRangeValidator.OnTextPaste">[docs]</a>    <span class="k">def</span> <span class="nf">OnTextPaste</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_TEXT_PASTE event, fires when an input receives pasted text</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.ClipboardTextEvent</span>
<span class="sd">            Contains information about the input receiving pasted text</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the text from the clipboard</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">wx</span><span class="o">.</span><span class="n">TheClipboard</span><span class="o">.</span><span class="n">IsOpened</span><span class="p">():</span> <span class="n">wx</span><span class="o">.</span><span class="n">TheClipboard</span><span class="o">.</span><span class="n">Open</span><span class="p">()</span>
        <span class="n">clipTextData</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextDataObject</span><span class="p">()</span>
        <span class="n">gotText</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TheClipboard</span><span class="o">.</span><span class="n">GetData</span><span class="p">(</span><span class="n">clipTextData</span><span class="p">)</span>
        <span class="c1"># make sure we actually got text</span>
        <span class="k">if</span> <span class="n">gotText</span><span class="p">:</span>
            <span class="c1"># validate the pasted string with inserted into the text already in the input</span>
            <span class="n">clipText</span> <span class="o">=</span> <span class="n">clipTextData</span><span class="o">.</span><span class="n">GetText</span><span class="p">()</span>
            <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
            <span class="n">spot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetInsertionPoint</span><span class="p">()</span>
            <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
            <span class="n">charsSelected</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">updatedText</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

            <span class="k">if</span> <span class="n">text</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">:</span>
                <span class="n">updatedText</span> <span class="o">=</span> <span class="n">clipText</span>
            <span class="k">elif</span> <span class="n">charsSelected</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">updatedText</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">spot</span><span class="p">]</span> <span class="o">+</span> <span class="n">clipText</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">spot</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">updatedText</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">clipText</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">sel</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span>


            <span class="n">test</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^[\-]?[0-9]+(\.[0-9]+)?(e[\-]?[0-9]+(?!\.))?((\*\*)|[\-\+\*\/\^])?[\-]?[0-9]*(\.[0-9]+)?(e[\-]?[0-9]+)?&quot;</span><span class="p">,</span> <span class="n">updatedText</span><span class="p">)</span>

            <span class="c1"># if the regex returned a match, set the input value to that match</span>
            <span class="k">if</span> <span class="n">test</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetInsertionPoint</span><span class="p">(</span><span class="n">spot</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">updatedText</span><span class="p">))</span>
                <span class="k">return</span></div>
<div class="viewcode-block" id="NumberRangeValidator.OnIdle"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.NumberRangeValidator.OnIdle">[docs]</a>    <span class="k">def</span> <span class="nf">OnIdle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_IDLE event, fires once whenever wx thinks the app has become idle</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.IdleEvent</span>
<span class="sd">            Contains information about the idle event</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># the idle event gets called a lot, so make sure we have the input before doing anything</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
            <span class="n">grandparent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetParent</span><span class="p">()</span>
            <span class="c1"># make sure all the conditions are met to show the popup</span>
            <span class="k">if</span> <span class="n">grandparent</span><span class="o">.</span><span class="n">hasValidatorDialog</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasDialog</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span><span class="p">:</span>
                <span class="c1"># reset conditions and show the popup</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hasDialog</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">val</span><span class="p">,</span> <span class="n">rangeBottom</span><span class="p">,</span> <span class="n">rangeTop</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;-infinity&#39;</span><span class="p">,</span> <span class="s1">&#39;infinity&#39;</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isInt</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())))</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">):</span>
                        <span class="n">rangeBottom</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">):</span>
                        <span class="n">rangeTop</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()))</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">):</span>
                        <span class="n">rangeBottom</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">):</span>
                        <span class="n">rangeTop</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="n">grandparent</span><span class="p">,</span> <span class="s2">&quot;The value &quot;</span> <span class="o">+</span> <span class="n">val</span> <span class="o">+</span> <span class="s2">&quot; is outside the range: &quot;</span> <span class="o">+</span> <span class="n">rangeBottom</span> <span class="o">+</span> <span class="s2">&quot; to &quot;</span> <span class="o">+</span> <span class="n">rangeTop</span><span class="p">)</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>

                <span class="c1"># result should always be OK, so hasValidatorDialog should always become False here</span>
                <span class="n">grandparent</span><span class="o">.</span><span class="n">hasValidatorDialog</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">result</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span></div></div>


<div class="viewcode-block" id="rereplace"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.rereplace">[docs]</a><span class="k">def</span> <span class="nf">rereplace</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">toReplace</span><span class="p">,</span> <span class="n">replacer</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Repeats replace until there are no instances of the toReplace string</span>
<span class="sd">    (e.g. if text=C:\\\\\\\\Users, toReplace=\\\\, replacer=\\ then C:\\\\\\\\Users -&gt; C:\\\\\\Users -&gt; C:\\\\Users -&gt; C:\\Users)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    text : string</span>
<span class="sd">        The string that should be modified</span>
<span class="sd">    toReplace : string</span>
<span class="sd">        The string to replace in &quot;text&quot;</span>
<span class="sd">    replacer : string</span>
<span class="sd">        The string to replace &quot;toReplace&quot; with</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    string.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">toReplace</span><span class="p">)</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">replacer</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">toReplace</span><span class="p">):]</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">toReplace</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span></div>


<div class="viewcode-block" id="findall"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.findall">[docs]</a><span class="k">def</span> <span class="nf">findall</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">searchStr</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds every instance in text of the given searchStr</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    text : string</span>
<span class="sd">        The string that should be searched</span>
<span class="sd">    searchStr : string</span>
<span class="sd">        The string to search for</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list[float].</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">instances</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">searchStr</span><span class="p">)</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">searchStr</span><span class="p">,</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">instances</span></div>


<div class="viewcode-block" id="FilePathValidator"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.FilePathValidator">[docs]</a><span class="k">class</span> <span class="nc">FilePathValidator</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Validator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to validate the formatting of a file/folder path, and that the file/folder exists on the file system.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isFolder</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">pathInput</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subdir</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the FilePathValidator class</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        isFolder : bool</span>
<span class="sd">            Whether the path should represent a folder or a file</span>
<span class="sd">        name : string</span>
<span class="sd">            The name of the input to appear if the text is invalid</span>
<span class="sd">        pathInput : wx.Window, defaults to None</span>
<span class="sd">            The input that contains the path for file inputs to use (isFolder is False), unused if isFolder is True</span>
<span class="sd">        subdir : string</span>
<span class="sd">            Optional subdirectory to look for files in</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        FilePathValidator</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FilePathValidator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">isFolder</span> <span class="o">=</span> <span class="n">isFolder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetWindow</span><span class="p">()</span>  <span class="c1"># this usually returns None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pathInput</span> <span class="o">=</span> <span class="n">pathInput</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subdir</span> <span class="o">=</span> <span class="n">subdir</span>

        <span class="c1"># make sure that files have a path to use since the input itself only includes the file name</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isFolder</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathInput</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;File validator must include an input that gives the folder path!&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nondigitCodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">WXK_BACK</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_DELETE</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_LEFT</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_RIGHT</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_C</span><span class="p">,</span>
                              <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_V</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_X</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_Z</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_Y</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restrictedChars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isFolder</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathInput</span> <span class="o">==</span> <span class="s2">&quot;self&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">restrictedChars</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hasDialog</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastValidPath</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="c1"># event bindings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnChar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_SET_FOCUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnSetFocus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_KILL_FOCUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnKillFocus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_IDLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnIdle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT_PASTE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnTextPaste</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathInput</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathInput</span> <span class="o">==</span> <span class="s2">&quot;self&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pathInput</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnText</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pathInput</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_KILL_FOCUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnKillFocus</span><span class="p">)</span>

    <span class="c1"># required methods from base class</span>
<div class="viewcode-block" id="FilePathValidator.Clone"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.FilePathValidator.Clone">[docs]</a>    <span class="k">def</span> <span class="nf">Clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">FilePathValidator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isFolder</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathInput</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">subdir</span><span class="p">)</span></div>

<div class="viewcode-block" id="FilePathValidator.Validate"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.FilePathValidator.Validate">[docs]</a>    <span class="k">def</span> <span class="nf">Validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="FilePathValidator.TransferToWindow"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.FilePathValidator.TransferToWindow">[docs]</a>    <span class="k">def</span> <span class="nf">TransferToWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="FilePathValidator.TransferFromWindow"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.FilePathValidator.TransferFromWindow">[docs]</a>    <span class="k">def</span> <span class="nf">TransferFromWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="c1"># utility methods</span>
<div class="viewcode-block" id="FilePathValidator.PathIsValid"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.FilePathValidator.PathIsValid">[docs]</a>    <span class="k">def</span> <span class="nf">PathIsValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns whether the given path can be found on the file system,</span>
<span class="sd">        appends the path in pathInput if isFolder is False</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : string</span>
<span class="sd">            The path to the folder or file to be validated</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathInput</span> <span class="o">==</span> <span class="s2">&quot;self&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">isFolder</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subdir</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pathInput</span><span class="o">.</span><span class="n">GetValue</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">subdir</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pathInput</span><span class="o">.</span><span class="n">GetValue</span><span class="p">(),</span> <span class="n">path</span><span class="p">))</span></div>

    <span class="c1"># event handlers</span>
<div class="viewcode-block" id="FilePathValidator.OnChar"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.FilePathValidator.OnChar">[docs]</a>    <span class="k">def</span> <span class="nf">OnChar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_CHAR event, fires before a character shows up in the input</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.KeyEvent</span>
<span class="sd">            Contains information about the key press that triggered this event</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetKeyCode</span><span class="p">()</span>
        <span class="n">char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>

        <span class="c1"># check if the character is valid in a file path</span>
        <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">printable</span> <span class="ow">and</span> <span class="n">char</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">restrictedChars</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># otherwise check if the &quot;character&quot; is some other control sequence (e.g., CTRL-Z)</span>
        <span class="k">if</span> <span class="n">code</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nondigitCodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_BACK</span> <span class="ow">or</span> <span class="n">code</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_DELETE</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># if we got here the character is invalid, so don&#39;t let it through</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="FilePathValidator.OnText"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.FilePathValidator.OnText">[docs]</a>    <span class="k">def</span> <span class="nf">OnText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_TEXT event, fires after a character shows up in the input</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.CommandEvent</span>
<span class="sd">            Contains information about text contained within the input when this event was fired</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># this runs when update() is called when the window loads, so in case input is still None, set it again</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetWindow</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
                <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetParent</span><span class="p">()</span><span class="o">.</span><span class="n">hasValidatorDialog</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>

        <span class="c1"># runs when the input is out of focus, mainly to handle improperly formated paths passed to SetValue()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">HasFocus</span><span class="p">():</span>

            <span class="c1"># scrub unwanted characters</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\ufeff</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">rereplace</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;//&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">PathIsValid</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># may not actually be valid, but we need something in case the user deletes all text without entering a valid path</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lastValidPath</span> <span class="o">=</span> <span class="n">text</span>

        <span class="c1"># change text color based on whether it is a valid path</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">PathIsValid</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetForegroundColour</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetForegroundColour</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">Refresh</span><span class="p">()</span>

        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span></div>

<div class="viewcode-block" id="FilePathValidator.OnSetFocus"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.FilePathValidator.OnSetFocus">[docs]</a>    <span class="k">def</span> <span class="nf">OnSetFocus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_SET_FOCUS event, fires before an input receives focus</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.FocusEvent</span>
<span class="sd">            Contains information about the input gaining focus</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if the OnText handler wasn&#39;t used, make sure the input is actually set</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetWindow</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
                <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastValidPath</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="c1"># may not actually be valid, but we need something in case the user deletes all text without entering a valid path</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lastValidPath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetParent</span><span class="p">()</span><span class="o">.</span><span class="n">hasValidatorDialog</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>

        <span class="c1"># scrub unwanted characters</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\ufeff</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">rereplace</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;//&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="c1"># change text color based on whether it is a valid path</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">PathIsValid</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetForegroundColour</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastValidPath</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lastValidPath</span> <span class="o">=</span> <span class="n">text</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetForegroundColour</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">Refresh</span><span class="p">()</span>

        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span></div>

<div class="viewcode-block" id="FilePathValidator.OnKillFocus"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.FilePathValidator.OnKillFocus">[docs]</a>    <span class="k">def</span> <span class="nf">OnKillFocus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_KILL_FOCUS event, fires before an input leaves focus</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.FocusEvent</span>
<span class="sd">            Contains information about the input losing focus</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># handles the case where the OnKillFocus handler is called by the pathInput (folder path) before the file input is focused by the user</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetWindow</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
                <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetParent</span><span class="p">()</span><span class="o">.</span><span class="n">hasValidatorDialog</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>

        <span class="c1"># change text to last valid path if the input is empty</span>
        <span class="k">if</span> <span class="n">text</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastValidPath</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastValidPath</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="c1"># scrub unwanted characters</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\ufeff</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">rereplace</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;//&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="c1"># add a trailing slash if it is missing</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isFolder</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">text</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>

        <span class="c1"># if the path is not valid, change the background color and set flags so the popup windows shows if necessary</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">PathIsValid</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
            <span class="n">grandparent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetParent</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">grandparent</span><span class="o">.</span><span class="n">hasValidatorDialog</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span><span class="p">:</span>
                <span class="n">grandparent</span><span class="o">.</span><span class="n">hasValidatorDialog</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hasDialog</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetForegroundColour</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">Refresh</span><span class="p">()</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># add the folder path to the input text if this is a file</span>
        <span class="c1"># this is handled automatically by PathIsValid, but we need it here to do the regex check</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isFolder</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathInput</span> <span class="o">==</span> <span class="s2">&quot;self&quot;</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathInput</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">text</span>

        <span class="n">finalTest</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># check file path based on os: nt -&gt; Windows, posix -&gt; Max/Linux</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span><span class="p">):</span>
            <span class="n">finalTest</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(([A-z]:\/)|(\.\.\/)+)?([^\/\.\r\n\ ]+\/)*([^\.]*(\.[^\.]+)?)?&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;posix&quot;</span><span class="p">):</span>
            <span class="n">finalTest</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;((~?\/)|(\.\.\/)+)?([^\/\.\r\n\ ]+\/)*([^\.]*(\.[^\.]+)?)?&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;java&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unsupported OS detected, you may also be using Jython.&quot;</span><span class="p">)</span>

        <span class="c1"># silently error if no regex match was found</span>
        <span class="c1"># if we got here the OS found the path, so we should be safe to let the input through</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">finalTest</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No regex match found for the input text: &quot;</span> <span class="o">+</span> <span class="n">text</span> <span class="o">+</span>
                  <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">This may be due to an invalid character in the input, or you may have an unsupported OS.&quot;</span><span class="p">)</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># set the text to the regex output, which may have scrubbed some other unwanted characters</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isFolder</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathInput</span> <span class="o">==</span> <span class="s2">&quot;self&quot;</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">finalTest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">finalTest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># the path should be valid if we got here, so set the text color to black</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetForegroundColour</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">Refresh</span><span class="p">()</span>

        <span class="c1"># update the last valid path and the input with the final text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastValidPath</span> <span class="o">=</span> <span class="n">text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span></div>

<div class="viewcode-block" id="FilePathValidator.OnTextPaste"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.FilePathValidator.OnTextPaste">[docs]</a>    <span class="k">def</span> <span class="nf">OnTextPaste</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_TEXT_PASTE event, fires when an input receives pasted text</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.ClipboardTextEvent</span>
<span class="sd">            Contains information about the input receiving pasted text</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the text from the clipboard</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">wx</span><span class="o">.</span><span class="n">TheClipboard</span><span class="o">.</span><span class="n">IsOpened</span><span class="p">():</span> <span class="n">wx</span><span class="o">.</span><span class="n">TheClipboard</span><span class="o">.</span><span class="n">Open</span><span class="p">()</span>
        <span class="n">clipTextData</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextDataObject</span><span class="p">()</span>
        <span class="n">gotText</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TheClipboard</span><span class="o">.</span><span class="n">GetData</span><span class="p">(</span><span class="n">clipTextData</span><span class="p">)</span>
        <span class="c1"># make sure we actually got text</span>
        <span class="k">if</span> <span class="n">gotText</span><span class="p">:</span>
            <span class="c1"># validate the pasted string with inserted into the text already in the input</span>
            <span class="n">clipText</span> <span class="o">=</span> <span class="n">clipTextData</span><span class="o">.</span><span class="n">GetText</span><span class="p">()</span>
            <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
            <span class="n">spot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetInsertionPoint</span><span class="p">()</span>
            <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
            <span class="n">charsSelected</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="c1"># scrub unwanted characters</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\ufeff</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">rereplace</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;//&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>

            <span class="c1"># insert the clipboard text</span>
            <span class="k">if</span> <span class="n">charsSelected</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">updatedText</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">spot</span><span class="p">]</span> <span class="o">+</span> <span class="n">clipText</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">spot</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">updatedText</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">clipText</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">sel</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span>


            <span class="c1"># formatting doesn&#39;t really matter at this point</span>
            <span class="c1"># but make sure the pasted text doesn&#39;t contain any invalid characters</span>
            <span class="n">test</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^[^&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">restrictedChars</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;]+$&quot;</span><span class="p">,</span> <span class="n">updatedText</span><span class="p">)</span>

            <span class="c1"># if not regex match was found, the text is invalid, so don&#39;t let it through</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">test</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="c1"># otherwise update the text color based on whether the new text is valid</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">PathIsValid</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetForegroundColour</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetForegroundColour</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">Refresh</span><span class="p">()</span>

            <span class="c1"># manually update the input, in case any unwanted characters were scrubbed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="c1"># don&#39;t call event.Skip() since we manually updated the input</span>
            <span class="k">return</span></div>

<div class="viewcode-block" id="FilePathValidator.OnIdle"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.FilePathValidator.OnIdle">[docs]</a>    <span class="k">def</span> <span class="nf">OnIdle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_IDLE event, fires once whenever wx thinks the app has become idle</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.IdleEvent</span>
<span class="sd">            Contains information about the idle event</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># the idle event gets called a lot, so make sure we have the input before doing anything</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
            <span class="n">grandparent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetParent</span><span class="p">()</span>
            <span class="c1"># make sure all the conditions are met to show the popup</span>
            <span class="k">if</span> <span class="n">grandparent</span><span class="o">.</span><span class="n">hasValidatorDialog</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasDialog</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span><span class="p">:</span>
                <span class="c1"># reset conditions and show the popup</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hasDialog</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dialogShown</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="n">grandparent</span><span class="p">,</span> <span class="s1">&#39;The system could not find specified path for &quot;&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span>
                                          <span class="s1">&#39;&quot;. Please check that the &#39;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;folder&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isFolder</span> <span class="k">else</span> <span class="s2">&quot;file&quot;</span><span class="p">)</span> <span class="o">+</span>
                                          <span class="s2">&quot; exists and that there are no spelling errors.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>

                <span class="c1"># result should always be OK, so hasValidatorDialog should always become False here</span>
                <span class="n">grandparent</span><span class="o">.</span><span class="n">hasValidatorDialog</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">result</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span></div></div>


<div class="viewcode-block" id="ListFormatValidator"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.ListFormatValidator">[docs]</a><span class="k">class</span> <span class="nc">ListFormatValidator</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Validator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to format and validate lists of ascii letters or numbers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">,</span> <span class="n">boundary</span><span class="p">,</span> <span class="n">restrictToNumeric</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">isInt</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setter for the isInt attribute, should always be used to set isInt outside of the constructor</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        delimiter : string</span>
<span class="sd">            The character that goes between elements, not allowed within elements.</span>
<span class="sd">        boundary : list[2]</span>
<span class="sd">            The characters that denote the beginning and end of the list, not allowed within elements.</span>
<span class="sd">        restrictToNumeric : bool</span>
<span class="sd">            Restrict elements to be numbers if true.</span>
<span class="sd">        range : list[2], defaults to None</span>
<span class="sd">            If restrictToNumeric is True, a two element list containing the lower bound (inclusive) and upper bound (exclusive) of the input.</span>
<span class="sd">        isInt : bool, defaults to None</span>
<span class="sd">            If restrictToNumeric is True, and isInt is True the input will only contain integer values. If false it will contain floating point values.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ListFormatValidator</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ListFormatValidator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="n">delimiter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span> <span class="o">=</span> <span class="n">boundary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numeric</span> <span class="o">=</span> <span class="n">restrictToNumeric</span>
        <span class="c1"># setup numeric only attributes</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">numeric</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">range</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">isInt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;If ListFormatValidator is restricted to numeric list items, range and isInt must be given&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">isInt</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validChars</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">SetRange</span><span class="p">(</span><span class="nb">range</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetIsInt</span><span class="p">(</span><span class="n">isInt</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sign</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetWindow</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nondigitCodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">WXK_BACK</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_DELETE</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_LEFT</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_RIGHT</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_C</span><span class="p">,</span>
                              <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_V</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_X</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_Z</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_Y</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restrictedChars</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

        <span class="c1"># event bindings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnChar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_SET_FOCUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnSetFocus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_KILL_FOCUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnKillFocus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT_PASTE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnTextPaste</span><span class="p">)</span>

<div class="viewcode-block" id="ListFormatValidator.SetRange"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.ListFormatValidator.SetRange">[docs]</a>    <span class="k">def</span> <span class="nf">SetRange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rng</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setter for the range attribute, should always be used to set the range outside of the constructor</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rng : list[2]</span>
<span class="sd">            A two element list containing the lower bound (inclusive) and upper bound (exclusive) of the input.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="n">rng</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-inf&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;inf&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
        <span class="c1"># if only negative numbers are allowed, make sure we have a negative sign</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span></div>

<div class="viewcode-block" id="ListFormatValidator.SetIsInt"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.ListFormatValidator.SetIsInt">[docs]</a>    <span class="k">def</span> <span class="nf">SetIsInt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isInt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setter for the isInt attribute, should always be used to set isInt outside of the constructor</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        isInt : bool</span>
<span class="sd">            If true, the input will only contain integer values. If false it will contain floating point values.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">isInt</span> <span class="o">=</span> <span class="n">isInt</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isInt</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validChars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">]</span>  <span class="c1"># decimal point not needed for ints</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validChars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">]</span></div>

    <span class="c1"># required methods from base class</span>
<div class="viewcode-block" id="ListFormatValidator.Clone"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.ListFormatValidator.Clone">[docs]</a>    <span class="k">def</span> <span class="nf">Clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">numeric</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ListFormatValidator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">numeric</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">isInt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ListFormatValidator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">numeric</span><span class="p">)</span></div>

<div class="viewcode-block" id="ListFormatValidator.Validate"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.ListFormatValidator.Validate">[docs]</a>    <span class="k">def</span> <span class="nf">Validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="ListFormatValidator.TransferToWindow"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.ListFormatValidator.TransferToWindow">[docs]</a>    <span class="k">def</span> <span class="nf">TransferToWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="ListFormatValidator.TransferFromWindow"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.ListFormatValidator.TransferFromWindow">[docs]</a>    <span class="k">def</span> <span class="nf">TransferFromWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="ListFormatValidator.checkBounds"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.ListFormatValidator.checkBounds">[docs]</a>    <span class="k">def</span> <span class="nf">checkBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">again</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether the given text is a valid number, and whether that number is within the range</span>

<span class="sd">        - If the value is not a valid number, but could be with additional input the return value is (True, None)</span>
<span class="sd">        - If the value contains characters that do not form a valid number the return value is (False, None)</span>
<span class="sd">        - If the value is a valid number but is not in the range the return value is (False, value)</span>
<span class="sd">        - If the value is a valid number and is in the range the return value is (True, value)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        txt : string</span>
<span class="sd">            The string to be checked against the range</span>
<span class="sd">        again : bool, defaults to True</span>
<span class="sd">            Whether the string should be checked again with the last character removed, useful for checking a value like &quot;1e&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple(bool,float).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># case where we have characters that &quot;could&quot; result in a valid number, but don&#39;t right now</span>
            <span class="k">if</span> <span class="n">txt</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span> <span class="ow">or</span> <span class="n">txt</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">letter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">validChars</span> <span class="ow">and</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">txt</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="c1"># try to convert the text to a number</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>

            <span class="c1"># make sure it&#39;s in the range</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># this means we don&#39;t have a valid number</span>
            <span class="c1"># but it could be a valid number with &quot;e&quot; or &quot;.&quot; on the end</span>
            <span class="c1"># so recheck ignoring the last character</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">txt</span> <span class="o">==</span> <span class="s2">&quot;--&quot;</span> <span class="ow">and</span> <span class="n">again</span><span class="p">:</span>  <span class="c1"># ignore false positive edge case</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBounds</span><span class="p">(</span><span class="n">txt</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div>

    <span class="c1"># event handlers</span>
<div class="viewcode-block" id="ListFormatValidator.OnChar"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.ListFormatValidator.OnChar">[docs]</a>    <span class="k">def</span> <span class="nf">OnChar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_CHAR event, fires before a character shows up in the input</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.KeyEvent</span>
<span class="sd">            Contains information about the key press that triggered this event</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get some useful info about the input&#39;s state</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetKeyCode</span><span class="p">()</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="n">spot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetInsertionPoint</span><span class="p">()</span>
        <span class="n">delimiters</span> <span class="o">=</span> <span class="n">findall</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>
        <span class="n">leftBoundary</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rightBoundary</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># handle backspaces</span>
        <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_BACK</span><span class="p">:</span>
            <span class="c1"># delete comma and space at the same time</span>
            <span class="k">if</span> <span class="n">text</span><span class="p">[</span><span class="n">spot</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span> <span class="ow">and</span> <span class="n">text</span><span class="p">[</span><span class="n">spot</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;,&quot;</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">spot</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">spot</span><span class="p">:]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetInsertionPoint</span><span class="p">(</span><span class="n">spot</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="c1"># make sure the boundary characters don&#39;t get deleted</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">spot</span> <span class="o">==</span> <span class="n">leftBoundary</span><span class="o">+</span><span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">spot</span> <span class="o">==</span> <span class="n">rightBoundary</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># handle delete</span>
        <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_DELETE</span><span class="p">:</span>
            <span class="c1"># delete comma and space at the same time</span>
            <span class="k">if</span> <span class="n">text</span><span class="p">[</span><span class="n">spot</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;,&quot;</span> <span class="ow">and</span> <span class="n">text</span><span class="p">[</span><span class="n">spot</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">spot</span><span class="p">]</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">spot</span><span class="o">+</span><span class="mi">2</span><span class="p">:]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetInsertionPoint</span><span class="p">(</span><span class="n">spot</span><span class="p">)</span>
            <span class="c1"># make sure the boundary characters don&#39;t get deleted</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">spot</span> <span class="o">==</span> <span class="n">leftBoundary</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">spot</span> <span class="o">==</span> <span class="n">rightBoundary</span><span class="p">:</span>
                <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># skip the cursor over the delimiter + space characters</span>
        <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_LEFT</span> <span class="ow">and</span> <span class="n">spot</span><span class="o">-</span><span class="mi">2</span> <span class="ow">in</span> <span class="n">delimiters</span><span class="p">:</span>
            <span class="c1"># make sure selection follows the same pattern</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">ShiftDown</span><span class="p">():</span>
                <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetSelection</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">sel</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetInsertionPoint</span><span class="p">(</span><span class="n">spot</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="n">code</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_LEFT</span><span class="p">:</span>
            <span class="c1"># manual normal selection for left since this behaves a bit differently than right</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">ShiftDown</span><span class="p">():</span>
                <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetSelection</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">sel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetInsertionPoint</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">spot</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_RIGHT</span> <span class="ow">and</span> <span class="n">spot</span> <span class="ow">in</span> <span class="n">delimiters</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetInsertionPoint</span><span class="p">(</span><span class="n">spot</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
            <span class="c1"># make sure selection follows the same pattern</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">ShiftDown</span><span class="p">():</span>
                <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetSelection</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># check if the &quot;character&quot; is some other control sequence (e.g., CTRL-Z)</span>
        <span class="k">elif</span> <span class="n">code</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nondigitCodes</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># otherwise we&#39;re adding some text, so make sure it&#39;ll go in the right spot</span>
        <span class="k">if</span> <span class="n">spot</span> <span class="o">&lt;=</span> <span class="n">leftBoundary</span> <span class="ow">or</span> <span class="n">spot</span> <span class="o">&gt;</span> <span class="n">rightBoundary</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># get the text for the list item we&#39;re modifying</span>
        <span class="n">upperTextBoundIdx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">delimiters</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">delimiters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">spot</span><span class="p">:</span>
                <span class="n">upperTextBoundIdx</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">upperTextBoundIdx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">upperTextBoundIdx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">delimiters</span><span class="p">)</span>

        <span class="n">thisText</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="c1"># editing one of the list items in the middle</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">upperTextBoundIdx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">delimiters</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">thisText</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="n">delimiters</span><span class="p">[</span><span class="n">upperTextBoundIdx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span><span class="n">delimiters</span><span class="p">[</span><span class="n">upperTextBoundIdx</span><span class="p">]]</span>
        <span class="c1"># editing the last list item</span>
        <span class="k">elif</span> <span class="n">upperTextBoundIdx</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">delimiters</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">delimiters</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">thisText</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="n">delimiters</span><span class="p">[</span><span class="n">upperTextBoundIdx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span><span class="n">rightBoundary</span><span class="p">]</span>
        <span class="c1"># editing the first list item</span>
        <span class="k">elif</span> <span class="n">upperTextBoundIdx</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">upperTextBoundIdx</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">delimiters</span><span class="p">):</span>
            <span class="n">thisText</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="n">leftBoundary</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="n">delimiters</span><span class="p">[</span><span class="n">upperTextBoundIdx</span><span class="p">]]</span>
        <span class="c1"># editing the only list item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">thisText</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="n">leftBoundary</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="n">rightBoundary</span><span class="p">]</span>

        <span class="c1"># let the delimiter character through as long as there&#39;s some text before it</span>
        <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">thisText</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># more strict rules if we are restricted to numeric characters</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">numeric</span><span class="p">:</span>
            <span class="c1"># if after the comma, only allow adding a space</span>
            <span class="k">if</span> <span class="n">text</span><span class="p">[</span><span class="n">spot</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;,&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">chr</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
                    <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
                <span class="k">return</span>

            <span class="c1"># handle typing a character that could occur in the middle of a number</span>
            <span class="k">if</span> <span class="nb">chr</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">validChars</span> <span class="ow">and</span> <span class="n">text</span> <span class="o">!=</span> <span class="s2">&quot;-&quot;</span> <span class="ow">and</span> <span class="n">text</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">spot</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="nb">chr</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="ow">or</span> <span class="p">(</span><span class="n">code</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">):</span>

                <span class="c1"># get what the new text would be after the character is typed</span>
                <span class="n">textAfterUpdate</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">thisText</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">textAfterUpdate</span> <span class="o">=</span> <span class="n">thisText</span><span class="p">[:</span><span class="n">spot</span><span class="p">]</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="o">+</span> <span class="n">thisText</span><span class="p">[</span><span class="n">spot</span><span class="p">:]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">textAfterUpdate</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>

                <span class="c1"># check if the new text would be valid</span>
                <span class="n">good</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBounds</span><span class="p">(</span><span class="n">textAfterUpdate</span><span class="p">)</span>

                <span class="c1"># if the character would or could probably produce a valid number, let it through</span>
                <span class="k">if</span> <span class="n">good</span><span class="p">:</span>
                    <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># if we are non-numeric, just make sure it&#39;s a printable ascii character that&#39;s not restricted (like delimiters)</span>
        <span class="n">char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">numeric</span> <span class="ow">and</span> <span class="nb">chr</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">printable</span> <span class="ow">and</span> <span class="n">char</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">restrictedChars</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># if we got here it&#39;s probably not valid, so don&#39;t let it through</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="ListFormatValidator.OnText"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.ListFormatValidator.OnText">[docs]</a>    <span class="k">def</span> <span class="nf">OnText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_TEXT event, fires after a character shows up in the input</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.CommandEvent</span>
<span class="sd">            Contains information about text contained within the input when this event was fired</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetWindow</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
                <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
                <span class="k">return</span>

        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>

        <span class="c1"># if the input value is changed when not in focus (usually by SetValue()), check to make sure it is valid</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">HasFocus</span><span class="p">():</span>
            <span class="n">regexString</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;[^&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">+</span> <span class="s2">&quot; ]*(?&lt;=[^&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">+</span> <span class="s2">&quot; </span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> \
                          <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;])(&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">+</span> <span class="s2">&quot; [^&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">+</span> <span class="s2">&quot;]+)*</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span>
                              <span class="mi">1</span><span class="p">]</span>
            <span class="n">initialTest</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">regexString</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

            <span class="c1"># check for invalid text</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">text</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">initialTest</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">)</span>  <span class="c1"># set to default</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetInsertionPoint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>

        <span class="n">spot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetInsertionPoint</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">text</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetInsertionPoint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># automatically add space after the delimiter</span>
        <span class="k">if</span> <span class="n">text</span><span class="p">[</span><span class="n">spot</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">spot</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">spot</span><span class="p">:]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetInsertionPoint</span><span class="p">(</span><span class="n">spot</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span></div>

<div class="viewcode-block" id="ListFormatValidator.OnSetFocus"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.ListFormatValidator.OnSetFocus">[docs]</a>    <span class="k">def</span> <span class="nf">OnSetFocus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_SET_FOCUS event, fires before an input receives focus</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.FocusEvent</span>
<span class="sd">            Contains information about the input gaining focus</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetWindow</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
                <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
                <span class="k">return</span>

        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="c1"># model for regex \[[^, ]*(?&lt;=[^, [])(, [^,]+)*\]</span>
        <span class="n">regexString</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;[^&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">+</span> <span class="s2">&quot; ]*(?&lt;=[^&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">+</span> <span class="s2">&quot; </span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;])(&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">+</span> <span class="s2">&quot; [^&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">+</span> <span class="s2">&quot;]+)*</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">initialTest</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">regexString</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

        <span class="c1"># check for invalid text</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">text</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">initialTest</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">)</span> <span class="c1"># set to default</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">SetInsertionPoint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>

        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span></div>

<div class="viewcode-block" id="ListFormatValidator.OnKillFocus"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.ListFormatValidator.OnKillFocus">[docs]</a>    <span class="k">def</span> <span class="nf">OnKillFocus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_KILL_FOCUS event, fires before an input leaves focus</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.FocusEvent</span>
<span class="sd">            Contains information about the input losing focus</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get useful information about the input state</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>

        <span class="n">leftBoundary</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rightBoundary</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># more strict rules for numeric values</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">numeric</span><span class="p">:</span>
            <span class="n">numsText</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="n">leftBoundary</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">rightBoundary</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>
            <span class="n">nums</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">numsText</span><span class="p">:</span>
                <span class="c1"># make sure there&#39;s text for us to validate</span>
                <span class="k">if</span> <span class="n">num</span><span class="p">:</span>
                    <span class="n">good</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBounds</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

                    <span class="c1"># make sure the text box contains a properly formatted number</span>
                    <span class="k">if</span> <span class="n">good</span> <span class="ow">and</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">val</span><span class="p">):</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isInt</span><span class="p">:</span>
                            <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)))</span>
                    <span class="k">if</span> <span class="n">val</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">isInt</span><span class="p">:</span> <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)))</span>
                    <span class="k">elif</span> <span class="n">val</span><span class="p">:</span> <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>


            <span class="n">newText</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># otherwise simply remove any blank items</span>
            <span class="n">items</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="n">leftBoundary</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">rightBoundary</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">item</span><span class="p">:</span> <span class="n">items</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">newText</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">newText</span><span class="p">)</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span></div>

<div class="viewcode-block" id="ListFormatValidator.OnTextPaste"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.ListFormatValidator.OnTextPaste">[docs]</a>    <span class="k">def</span> <span class="nf">OnTextPaste</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_TEXT_PASTE event, fires when an input receives pasted text</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.ClipboardTextEvent</span>
<span class="sd">            Contains information about the input receiving pasted text</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the text from the clipboard</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">wx</span><span class="o">.</span><span class="n">TheClipboard</span><span class="o">.</span><span class="n">IsOpened</span><span class="p">():</span> <span class="n">wx</span><span class="o">.</span><span class="n">TheClipboard</span><span class="o">.</span><span class="n">Open</span><span class="p">()</span>
        <span class="n">clipTextData</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextDataObject</span><span class="p">()</span>
        <span class="n">gotText</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TheClipboard</span><span class="o">.</span><span class="n">GetData</span><span class="p">(</span><span class="n">clipTextData</span><span class="p">)</span>
        <span class="c1"># make sure we actually got text</span>
        <span class="k">if</span> <span class="n">gotText</span><span class="p">:</span>
            <span class="c1"># get some useful info about the input&#39;s state</span>
            <span class="n">clipText</span> <span class="o">=</span> <span class="n">clipTextData</span><span class="o">.</span><span class="n">GetText</span><span class="p">()</span>
            <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
            <span class="n">spot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetInsertionPoint</span><span class="p">()</span>
            <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
            <span class="n">charsSelected</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="c1"># validate the pasted string with inserted into the text already in the input</span>
            <span class="k">if</span> <span class="n">charsSelected</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">updatedText</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">spot</span><span class="p">]</span> <span class="o">+</span> <span class="n">clipText</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">spot</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">updatedText</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">clipText</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">sel</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span>

            <span class="n">delimiters</span> <span class="o">=</span> <span class="n">findall</span><span class="p">(</span><span class="n">updatedText</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>
            <span class="n">leftBoundary</span> <span class="o">=</span> <span class="n">updatedText</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">rightBoundary</span> <span class="o">=</span> <span class="n">updatedText</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="c1"># we&#39;re adding some text, so make sure it&#39;ll go in the right spot</span>
            <span class="k">if</span> <span class="n">spot</span> <span class="o">&lt;=</span> <span class="n">leftBoundary</span> <span class="ow">or</span> <span class="n">spot</span> <span class="o">&gt;</span> <span class="n">rightBoundary</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="c1"># model for regex \[[^, ]*(?&lt;=[^, [])(, [^,]+)*\]</span>
            <span class="n">regexString</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;[^&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">+</span> <span class="s2">&quot; ]*(?&lt;=[^&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">+</span> <span class="s2">&quot; </span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> \
                          <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;])(&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">+</span> <span class="s2">&quot; [^&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">+</span> <span class="s2">&quot;]+)*</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span>
                              <span class="mi">1</span><span class="p">]</span>
            <span class="n">initialTest</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">regexString</span><span class="p">,</span> <span class="n">updatedText</span><span class="p">)</span>

            <span class="c1"># get the text for the list item we&#39;re modifying</span>
            <span class="n">upperTextBoundIdx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">delimiters</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">delimiters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">spot</span><span class="p">:</span>
                    <span class="n">upperTextBoundIdx</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">upperTextBoundIdx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">upperTextBoundIdx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">delimiters</span><span class="p">)</span>

            <span class="n">thisText</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">upperTextBoundIdx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">delimiters</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">thisText</span> <span class="o">=</span> <span class="n">updatedText</span><span class="p">[</span><span class="n">delimiters</span><span class="p">[</span><span class="n">upperTextBoundIdx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span><span class="n">delimiters</span><span class="p">[</span><span class="n">upperTextBoundIdx</span><span class="p">]]</span>
            <span class="k">elif</span> <span class="n">upperTextBoundIdx</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">delimiters</span><span class="p">):</span>
                <span class="n">thisText</span> <span class="o">=</span> <span class="n">updatedText</span><span class="p">[</span><span class="n">delimiters</span><span class="p">[</span><span class="n">upperTextBoundIdx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span><span class="n">rightBoundary</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">upperTextBoundIdx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">thisText</span> <span class="o">=</span> <span class="n">updatedText</span><span class="p">[</span><span class="n">leftBoundary</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="n">delimiters</span><span class="p">[</span><span class="n">upperTextBoundIdx</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">thisText</span> <span class="o">=</span> <span class="n">updatedText</span><span class="p">[</span><span class="n">leftBoundary</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="n">rightBoundary</span><span class="p">]</span>

            <span class="c1"># if restricted to numeric list items, make sure the new text is still a valid number</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">numeric</span><span class="p">:</span>
                <span class="c1"># check if the new text would be valid</span>
                <span class="n">good</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBounds</span><span class="p">(</span><span class="n">thisText</span><span class="p">)</span>

                <span class="c1"># if the character would or could probably produce a valid number, let it through</span>
                <span class="k">if</span> <span class="n">good</span><span class="p">:</span>
                    <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
                <span class="k">return</span>

            <span class="c1"># check for invalid text</span>
            <span class="k">if</span> <span class="n">updatedText</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">)</span> <span class="ow">or</span> <span class="n">initialTest</span><span class="p">:</span>
                <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span></div></div>


<div class="viewcode-block" id="AlphaNumericFileValidator"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.AlphaNumericFileValidator">[docs]</a><span class="k">class</span> <span class="nc">AlphaNumericFileValidator</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Validator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to format and validate fields containing text that should be valid on the file system (file names, extensions)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for AlphaNumericFileValidator</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        AlphaNumericFileValidator</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AlphaNumericFileValidator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetWindow</span><span class="p">()</span>  <span class="c1"># this usually returns None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nondigitCodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">WXK_BACK</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_DELETE</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_LEFT</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_RIGHT</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_C</span><span class="p">,</span>
                              <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_V</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_X</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_Z</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_CONTROL_Y</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validChars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">]</span>

        <span class="c1"># event bindings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnChar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_SET_FOCUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnSetFocus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_KILL_FOCUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnKillFocus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT_PASTE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnTextPaste</span><span class="p">)</span>

    <span class="c1"># required methods from base class</span>
<div class="viewcode-block" id="AlphaNumericFileValidator.Clone"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.AlphaNumericFileValidator.Clone">[docs]</a>    <span class="k">def</span> <span class="nf">Clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">AlphaNumericFileValidator</span><span class="p">()</span></div>

<div class="viewcode-block" id="AlphaNumericFileValidator.Validate"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.AlphaNumericFileValidator.Validate">[docs]</a>    <span class="k">def</span> <span class="nf">Validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="AlphaNumericFileValidator.TransferToWindow"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.AlphaNumericFileValidator.TransferToWindow">[docs]</a>    <span class="k">def</span> <span class="nf">TransferToWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="AlphaNumericFileValidator.TransferFromWindow"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.AlphaNumericFileValidator.TransferFromWindow">[docs]</a>    <span class="k">def</span> <span class="nf">TransferFromWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="c1"># event handlers</span>
<div class="viewcode-block" id="AlphaNumericFileValidator.OnChar"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.AlphaNumericFileValidator.OnChar">[docs]</a>    <span class="k">def</span> <span class="nf">OnChar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_CHAR event, fires before a character shows up in the input</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.KeyEvent</span>
<span class="sd">            Contains information about the key press that triggered this event</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetKeyCode</span><span class="p">()</span>
        <span class="n">char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>

        <span class="c1"># check if the &quot;character&quot; is some other control sequence (e.g., CTRL-Z)</span>
        <span class="k">if</span> <span class="n">code</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nondigitCodes</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="ow">or</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="ow">or</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">validChars</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="AlphaNumericFileValidator.OnText"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.AlphaNumericFileValidator.OnText">[docs]</a>    <span class="k">def</span> <span class="nf">OnText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_TEXT event, fires after a character shows up in the input</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.CommandEvent</span>
<span class="sd">            Contains information about text contained within the input when this event was fired</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetWindow</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
                <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>

        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[a-zA-Z0-9\-\_\. ]*&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">test</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">test</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span></div>

<div class="viewcode-block" id="AlphaNumericFileValidator.OnSetFocus"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.AlphaNumericFileValidator.OnSetFocus">[docs]</a>    <span class="k">def</span> <span class="nf">OnSetFocus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_SET_FOCUS event, fires before an input receives focus</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.FocusEvent</span>
<span class="sd">            Contains information about the input gaining focus</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetWindow</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
                <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>

        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[a-zA-Z0-9\-\_\. ]*&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">test</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">test</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span></div>

<div class="viewcode-block" id="AlphaNumericFileValidator.OnKillFocus"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.AlphaNumericFileValidator.OnKillFocus">[docs]</a>    <span class="k">def</span> <span class="nf">OnKillFocus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_KILL_FOCUS event, fires before an input leaves focus</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.FocusEvent</span>
<span class="sd">            Contains information about the input losing focus</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">text</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[a-zA-Z0-9\-\_\. ]*&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">test</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">test</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span></div>

<div class="viewcode-block" id="AlphaNumericFileValidator.OnTextPaste"><a class="viewcode-back" href="../PyEMTG/inputValidators.html#inputValidators.AlphaNumericFileValidator.OnTextPaste">[docs]</a>    <span class="k">def</span> <span class="nf">OnTextPaste</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for the wx.EVT_TEXT_PASTE event, fires when an input receives pasted text</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : wx.ClipboardTextEvent</span>
<span class="sd">            Contains information about the input receiving pasted text</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the text from the clipboard</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">wx</span><span class="o">.</span><span class="n">TheClipboard</span><span class="o">.</span><span class="n">IsOpened</span><span class="p">():</span> <span class="n">wx</span><span class="o">.</span><span class="n">TheClipboard</span><span class="o">.</span><span class="n">Open</span><span class="p">()</span>
        <span class="n">clipTextData</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextDataObject</span><span class="p">()</span>
        <span class="n">gotText</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TheClipboard</span><span class="o">.</span><span class="n">GetData</span><span class="p">(</span><span class="n">clipTextData</span><span class="p">)</span>
        <span class="c1"># make sure we actually got text</span>
        <span class="k">if</span> <span class="n">gotText</span><span class="p">:</span>
            <span class="c1"># get some useful info about the input&#39;s state</span>
            <span class="n">clipText</span> <span class="o">=</span> <span class="n">clipTextData</span><span class="o">.</span><span class="n">GetText</span><span class="p">()</span>
            <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
            <span class="n">spot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetInsertionPoint</span><span class="p">()</span>
            <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
            <span class="n">charsSelected</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="c1"># validate the pasted string with inserted into the text already in the input</span>
            <span class="k">if</span> <span class="n">charsSelected</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">updatedText</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">spot</span><span class="p">]</span> <span class="o">+</span> <span class="n">clipText</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">spot</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">updatedText</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">clipText</span> <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">sel</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span>

            <span class="n">test</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^[a-zA-Z0-9\-\_\. ]*$&quot;</span><span class="p">,</span> <span class="n">updatedText</span><span class="p">)</span>

            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">test</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">text</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">ChangeValue</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">EMTG python</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../PyEMTG/index.html">PyEMTG documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PEATSA/index.html">PEATSA documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OptionsOverhaul/index.html">OptionsOverhaul documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Jacob Englander, Donald Ellison, Jeremy Knittel, Noble Hatten.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
    </div>

    

    
  </body>
</html>