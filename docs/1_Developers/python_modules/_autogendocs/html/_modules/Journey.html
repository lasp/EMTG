<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Journey &#8212; EMTG python  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=61cd365c" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=12dfc556" />
    <script src="../_static/documentation_options.js?v=7f41d439"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for Journey</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright (c) 2024 The Regents of the University of Colorado.</span>
<span class="c1"># All Other Rights Reserved.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Journey.py</span>
<span class="sd">========================</span>
<span class="sd">This file contains the Journey class.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">MissionEvent</span>
<span class="kn">import</span> <span class="nn">EOM</span>
<span class="kn">import</span> <span class="nn">AstroFunctions</span>
<span class="kn">import</span> <span class="nn">ThrottleTable</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<div class="viewcode-block" id="Journey">
<a class="viewcode-back" href="../PyEMTG/Journey.html#Journey.Journey">[docs]</a>
<span class="k">class</span> <span class="nc">Journey</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Contains attributes and methods related to the &#39;output&#39; of an EMTG journey.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parent : Mission object</span>
<span class="sd">        The Mission of which this Journey is a member.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for Journey class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parent : `:class:Mission` object</span>
<span class="sd">            The Mission of which this Journey is a member.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The Mission of which this Journey is a member.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span> <span class="o">=</span> <span class="p">[]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List of missionevents for this Journey&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journey_name</span> <span class="o">=</span> <span class="s2">&quot;AJourney&quot;</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Journey name&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journey_number</span> <span class="o">=</span> <span class="mi">0</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Journey number, 0-indexed&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">central_body</span> <span class="o">=</span> <span class="s2">&quot;Sun&quot;</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Journey central body (a string)&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">central_body_radius</span> <span class="o">=</span> <span class="mf">4.379e+6</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Radius of central body, km&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="mf">132712440017.99</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gravitational parameter of central body, km^3/s2&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LU</span> <span class="o">=</span> <span class="mf">1.49597870691e+8</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Length unit for this journey, used for scaling&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TU</span> <span class="o">=</span> <span class="mf">5022642.890912973</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Time unit for this journey, used for scaling&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundary_states</span> <span class="o">=</span> <span class="p">[]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Boundary states for this journey (a list)&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flyby_periapse_states</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thruster_duty_cycle</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journey_post_arrival_deltav</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journey_post_arrival_propellant_used</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journey_initial_mass_increment</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journey_final_mass_increment</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journey_flight_time_days</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1">#default values for entry things</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journey_entryinterface_velocity_with_respect_to_rotating_atmosphere</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journey_entry_landing_interface_point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_latitude</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_longitude</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_sun_angle</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journey_arrival_spacecraft_sun_Earth_angle</span> <span class="o">=</span> <span class="mf">180.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_frame</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha0</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta0</span> <span class="o">=</span> <span class="mf">0.0</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">BoundaryConstraintOutputs</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">return</span>
    
<div class="viewcode-block" id="Journey.GetBoundaryConstraintOutputValueByName">
<a class="viewcode-back" href="../PyEMTG/Journey.html#Journey.Journey.GetBoundaryConstraintOutputValueByName">[docs]</a>
    <span class="k">def</span> <span class="nf">GetBoundaryConstraintOutputValueByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stringIn</span><span class="p">,</span> <span class="n">floatOrStringOut</span> <span class="o">=</span> <span class="s2">&quot;string&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return float value of boundary constraint. Which boundary constraint</span>
<span class="sd">        is determined by looking for input string in self.BoundaryConstraintOutputs.</span>
<span class="sd">        The first time string is found, the value of that boundary constraint is returned</span>
<span class="sd">        as the type specified by floatOrStringOut.</span>
<span class="sd">        If string is never found, then None is returned</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        stringIn : string </span>
<span class="sd">            string to search for in the &quot;left-hand sides&quot; of self.BoundaryConstraintOutputs</span>
<span class="sd">        floatOrStringOut : string, optional</span>
<span class="sd">            how to output the returned value: &quot;string&quot; or &quot;float&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BoundaryConstraintOutputs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># there are not boundary constraint outputs to parse</span>
            <span class="k">return</span> <span class="kc">None</span>
        
        <span class="k">for</span> <span class="n">bc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">BoundaryConstraintOutputs</span><span class="p">:</span>
            <span class="c1"># get the text part of the boundary constraint output</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">bc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="c1"># look for string</span>
            <span class="k">if</span> <span class="n">stringIn</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">bc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">floatOrStringOut</span> <span class="o">==</span> <span class="s2">&quot;string&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">value</span>
                <span class="k">elif</span> <span class="n">floatOrStringOut</span> <span class="o">==</span> <span class="s2">&quot;float&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            
        <span class="c1"># if we made it this far, we didn&#39;t find it, so return None</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Journey.PlotJourney">
<a class="viewcode-back" href="../PyEMTG/Journey.html#Journey.Journey.PlotJourney">[docs]</a>
    <span class="k">def</span> <span class="nf">PlotJourney</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">JourneyAxes</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="p">,</span> <span class="n">CustomLabels</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot each mission event</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        JourneyAxes : Matplotlib axes</span>
<span class="sd">            Matplotlib axes on which to plot</span>
<span class="sd">        PlotOptions : PlotOptions object</span>
<span class="sd">            Options for plotting</span>
<span class="sd">        CustomLabels : List of lists, optional</span>
<span class="sd">            [[eventNumber, labelstring], ...]. The default is None.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">BeforeMatchPoint</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">ShowMissionEvents</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="c1">#do we have a custom label?</span>
                <span class="k">if</span> <span class="n">CustomLabels</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">CustomLabels</span><span class="p">:</span> <span class="c1">#this is a list of lists, [eventNumber, labelstring]</span>
                        <span class="k">if</span> <span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">event</span><span class="o">.</span><span class="n">EventNumber</span><span class="p">:</span>
                            <span class="n">BeforeMatchPoint</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">PlotEvent</span><span class="p">(</span><span class="n">JourneyAxes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="p">,</span> <span class="n">BeforeMatchPoint</span><span class="p">,</span> <span class="n">label</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">BeforeMatchPoint</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">PlotEvent</span><span class="p">(</span><span class="n">JourneyAxes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="p">,</span> <span class="n">BeforeMatchPoint</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">BeforeMatchPoint</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">PlotEvent</span><span class="p">(</span><span class="n">JourneyAxes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="p">,</span> <span class="n">BeforeMatchPoint</span><span class="p">)</span></div>


        

<div class="viewcode-block" id="Journey.PlotJourneyBoundaryOrbits">
<a class="viewcode-back" href="../PyEMTG/Journey.html#Journey.Journey.PlotJourneyBoundaryOrbits">[docs]</a>
    <span class="k">def</span> <span class="nf">PlotJourneyBoundaryOrbits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">JourneyAxes</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">ode</span>

        <span class="k">for</span> <span class="n">boundaryStateIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary_states</span><span class="p">)):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">boundaryStateIndex</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Location</span> <span class="o">==</span> <span class="s1">&#39;free point&#39;</span><span class="p">)</span> \
                <span class="ow">or</span> <span class="p">(</span><span class="n">boundaryStateIndex</span> <span class="o">==</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary_states</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Location</span> <span class="o">==</span> <span class="s1">&#39;free point&#39;</span><span class="p">))</span> \
                <span class="ow">or</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">ShowFreePointBoundaryOrbits</span><span class="p">:</span>
                <span class="n">boundarystate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary_states</span><span class="p">[</span><span class="n">boundaryStateIndex</span><span class="p">]</span>
                <span class="n">BoundaryStateScaled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">boundarystate</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span>
                <span class="n">BoundaryStateScaled</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TU</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">BoundaryStateScaled</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">BoundaryStateScaled</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="k">continue</span>
                
                <span class="n">a</span> <span class="o">=</span> <span class="n">r</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">r</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">T</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">T</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">LU</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">TU</span>

                <span class="n">StateIntegrateObject</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">EOM</span><span class="o">.</span><span class="n">EOM_inertial_2body</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">EOM</span><span class="o">.</span><span class="n">EOM_jacobian_intertial_2body</span><span class="p">)</span><span class="o">.</span><span class="n">set_integrator</span><span class="p">(</span><span class="s1">&#39;dop853&#39;</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1.0e-8</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1.0e-8</span><span class="p">)</span>
                <span class="n">StateIntegrateObject</span><span class="o">.</span><span class="n">set_initial_value</span><span class="p">(</span><span class="n">BoundaryStateScaled</span><span class="p">)</span><span class="o">.</span><span class="n">set_f_params</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">set_jac_params</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

                <span class="n">dt</span> <span class="o">=</span> <span class="n">T</span> <span class="o">/</span> <span class="mi">10000</span>
                <span class="n">StateHistory</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="n">epoch</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">JulianDate</span> <span class="o">-</span> <span class="mf">2451544.5</span><span class="p">)</span> <span class="o">*</span> <span class="mf">86400.0</span>
                <span class="k">while</span> <span class="n">StateIntegrateObject</span><span class="o">.</span><span class="n">successful</span><span class="p">()</span> <span class="ow">and</span> <span class="n">StateIntegrateObject</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">T</span> <span class="o">*</span> <span class="mf">1.01</span><span class="p">:</span>
                    <span class="n">epoch</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">TU</span>
                    <span class="n">stateArray</span> <span class="o">=</span> <span class="n">StateIntegrateObject</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">StateIntegrateObject</span><span class="o">.</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span>
                    <span class="n">state</span> <span class="o">=</span> <span class="p">[</span><span class="n">stateArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span><span class="p">,</span> <span class="n">stateArray</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span><span class="p">,</span> <span class="n">stateArray</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span><span class="p">,</span> <span class="n">epoch</span><span class="p">]</span>
                    <span class="n">StateHistory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

                <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">Y</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">Z</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">StateLine</span> <span class="ow">in</span> <span class="n">StateHistory</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span> <span class="o">!=</span> <span class="s1">&#39;Journey central body&#39;</span><span class="p">:</span>
                        <span class="kn">import</span> <span class="nn">spiceypy</span>
                        <span class="n">journey_central_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_body</span>
                            
                        <span class="k">if</span> <span class="n">journey_central_body</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Mars&#39;</span><span class="p">,</span><span class="s1">&#39;Jupiter&#39;</span><span class="p">,</span><span class="s1">&#39;Uranus&#39;</span><span class="p">,</span><span class="s1">&#39;Neptune&#39;</span><span class="p">,</span><span class="s1">&#39;Pluto&#39;</span><span class="p">]:</span>
                            <span class="n">journey_central_body</span> <span class="o">=</span> <span class="n">journey_central_body</span> <span class="o">+</span> <span class="s1">&#39; Barycenter&#39;</span>

                        <span class="k">if</span> <span class="n">journey_central_body</span> <span class="o">!=</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">:</span>
                            <span class="n">body_state</span><span class="p">,</span> <span class="n">LT</span> <span class="o">=</span> <span class="n">spiceypy</span><span class="o">.</span><span class="n">spkezr</span><span class="p">(</span><span class="n">journey_central_body</span><span class="p">,</span> <span class="n">StateLine</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;J2000&#39;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">)</span>
                            
                            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                            <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">body_state</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                            <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateLine</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

                <span class="n">JourneyAxes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Journey.PlotJourneyCentralBodyOrbits">
<a class="viewcode-back" href="../PyEMTG/Journey.html#Journey.Journey.PlotJourneyCentralBodyOrbits">[docs]</a>
    <span class="k">def</span> <span class="nf">PlotJourneyCentralBodyOrbits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">JourneyAxes</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span> <span class="o">!=</span> <span class="s1">&#39;Journey central body&#39;</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">spiceypy</span>
            <span class="n">journey_central_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_body</span>
                            
            <span class="k">if</span> <span class="n">journey_central_body</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Mars&#39;</span><span class="p">,</span><span class="s1">&#39;Jupiter&#39;</span><span class="p">,</span><span class="s1">&#39;Uranus&#39;</span><span class="p">,</span><span class="s1">&#39;Neptune&#39;</span><span class="p">,</span><span class="s1">&#39;Pluto&#39;</span><span class="p">]:</span>
                <span class="n">journey_central_body</span> <span class="o">=</span> <span class="n">journey_central_body</span> <span class="o">+</span> <span class="s1">&#39; Barycenter&#39;</span>

            <span class="k">if</span> <span class="n">journey_central_body</span> <span class="o">!=</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">:</span>
                <span class="n">body_state</span><span class="p">,</span> <span class="n">LT</span> <span class="o">=</span> <span class="n">spiceypy</span><span class="o">.</span><span class="n">spkezr</span><span class="p">(</span><span class="n">journey_central_body</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">JulianDate</span> <span class="o">-</span> <span class="mf">2451545.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">86400.0</span><span class="p">,</span> <span class="s1">&#39;J2000&#39;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">)</span>
                
                
                <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">body_state</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">body_state</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>

                <span class="n">mu</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Mercury&#39;</span><span class="p">:</span>                   <span class="mf">22031.780000</span><span class="p">,</span>
                      <span class="s1">&#39;Venus&#39;</span><span class="p">:</span>                    <span class="mf">324858.592000</span><span class="p">,</span>
                      <span class="s1">&#39;Earth&#39;</span><span class="p">:</span>                    <span class="mf">398600.435436</span><span class="p">,</span>
                      <span class="s1">&#39;Mars&#39;</span><span class="p">:</span>                      <span class="mf">42828.375214</span><span class="p">,</span>
                      <span class="s1">&#39;Jupiter Barycenter&#39;</span><span class="p">:</span>    <span class="mf">126712764.800000</span><span class="p">,</span>
                      <span class="s1">&#39;Saturn Barycenter&#39;</span><span class="p">:</span>      <span class="mf">37940585.200000</span><span class="p">,</span>
                      <span class="s1">&#39;Uranus Barycenter&#39;</span><span class="p">:</span>       <span class="mf">5794548.600000</span><span class="p">,</span>
                      <span class="s1">&#39;Neptune Barycenter&#39;</span><span class="p">:</span>      <span class="mf">6836527.100580</span><span class="p">,</span>
                      <span class="s1">&#39;Pluto Barycenter&#39;</span><span class="p">:</span>            <span class="mf">977.000000</span><span class="p">,</span>
                      <span class="s1">&#39;Sun&#39;</span><span class="p">:</span>                <span class="mf">132712440041.939400</span><span class="p">,</span>
                      <span class="s1">&#39;Moon&#39;</span><span class="p">:</span>                       <span class="mf">4902.800066</span><span class="p">,</span>
                      <span class="s1">&#39;Earth-Moon Barycenter&#39;</span><span class="p">:</span>    <span class="mf">403503.235502</span><span class="p">}</span>

                <span class="n">elements</span> <span class="o">=</span> <span class="n">spiceypy</span><span class="o">.</span><span class="n">oscltx</span><span class="p">(</span><span class="n">body_state</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">JulianDate</span> <span class="o">-</span> <span class="mf">2451545.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">86400.0</span><span class="p">,</span> <span class="n">mu</span><span class="p">[</span><span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">])</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="c1">#a = r / (2.0 - r*v*v)</span>
                <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">T</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span>  <span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">mu</span><span class="p">[</span><span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">])</span> 
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">T</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">TU</span>

                <span class="n">t0</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">JulianDate</span> <span class="o">-</span> <span class="mf">2451545.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">86400.0</span>
                <span class="n">tf</span> <span class="o">=</span> <span class="n">t0</span> <span class="o">+</span> <span class="n">T</span>
                <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">Y</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">Z</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
                    <span class="n">body_state</span><span class="p">,</span> <span class="n">LT</span> <span class="o">=</span> <span class="n">spiceypy</span><span class="o">.</span><span class="n">spkezr</span><span class="p">(</span><span class="n">journey_central_body</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="s1">&#39;J2000&#39;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotCentralBody</span><span class="p">)</span>
                            
                    <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">body_state</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">body_state</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">body_state</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

                <span class="n">JourneyAxes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Journey.UpdateLabelPosition">
<a class="viewcode-back" href="../PyEMTG/Journey.html#Journey.Journey.UpdateLabelPosition">[docs]</a>
    <span class="k">def</span> <span class="nf">UpdateLabelPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Figure</span><span class="p">,</span> <span class="n">Axes</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">UpdateLabelPosition</span><span class="p">(</span><span class="n">Figure</span><span class="p">,</span> <span class="n">Axes</span><span class="p">)</span></div>


<div class="viewcode-block" id="Journey.PlotPhaseBoundariesOnDataPlot">
<a class="viewcode-back" href="../PyEMTG/Journey.html#Journey.Journey.PlotPhaseBoundariesOnDataPlot">[docs]</a>
    <span class="k">def</span> <span class="nf">PlotPhaseBoundariesOnDataPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DataAxes</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="p">,</span> <span class="n">firstpass</span><span class="p">,</span> <span class="n">Ybounds</span><span class="p">):</span>

        <span class="c1">#create vertical lines at important events</span>
        <span class="n">date_string_vector</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">boundarylegendflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">burnlegendflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;upwr_flyby&#39;</span><span class="p">,</span> <span class="s1">&#39;pwr_flyby&#39;</span><span class="p">,</span> <span class="s1">&#39;LT_rndzvs&#39;</span><span class="p">,</span> <span class="s1">&#39;rendezvous&#39;</span><span class="p">,</span> <span class="s1">&#39;intercept&#39;</span><span class="p">,</span> <span class="s1">&#39;insertion&#39;</span><span class="p">,</span> <span class="s1">&#39;match-vinf&#39;</span><span class="p">,</span> <span class="s1">&#39;launch&#39;</span><span class="p">,</span> <span class="s1">&#39;departure&#39;</span><span class="p">,</span> <span class="s2">&quot;begin_spiral&quot;</span><span class="p">,</span> <span class="s2">&quot;end_spiral&quot;</span><span class="p">]:</span>
                <span class="n">event_epoch</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GregorianDate</span><span class="p">,</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">firstpass</span> <span class="ow">and</span> <span class="n">boundarylegendflag</span><span class="p">:</span>
                    <span class="n">DataAxes</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">event_epoch</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">Ybounds</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="c1">#, label=&#39;Phase boundary&#39;)</span>
                    <span class="n">boundarylegendflag</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">DataAxes</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">event_epoch</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">Ybounds</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;chem_burn&#39;</span><span class="p">:</span>
                <span class="n">event_epoch</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GregorianDate</span><span class="p">,</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">firstpass</span> <span class="ow">and</span> <span class="n">burnlegendflag</span><span class="p">:</span>
                    <span class="n">DataAxes</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">event_epoch</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">Ybounds</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Deep-Space Maneuver&#39;</span><span class="p">)</span>
                    <span class="n">burnlegendflag</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">DataAxes</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">event_epoch</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">Ybounds</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></div>



<div class="viewcode-block" id="Journey.GenerateJourneyDataPlot">
<a class="viewcode-back" href="../PyEMTG/Journey.html#Journey.Journey.GenerateJourneyDataPlot">[docs]</a>
    <span class="k">def</span> <span class="nf">GenerateJourneyDataPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DataAxesLeft</span><span class="p">,</span> <span class="n">DataAxesRight</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="p">,</span> <span class="n">firstpass</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">math</span>
        <span class="kn">import</span> <span class="nn">astropy</span>
        <span class="c1">#generate a vector of dates</span>
        <span class="n">date_string_vector</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;match_point&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;upwr_flyby&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;pwr_flyby&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;LT_rndzvs&#39;</span><span class="p">:</span>
                <span class="n">date_string_vector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GregorianDate</span><span class="p">)</span>

        <span class="n">date_vector</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">date_string_vector</span><span class="p">]</span>

        <span class="c1">#dummy line across the bottom so that neither axes object crashes</span>
        <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">date_vector</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">DataAxesRight</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">date_vector</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>

        <span class="c1">#plot distance from central body</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotR</span><span class="p">:</span>
            <span class="n">Rvector</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;match_point&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;upwr_flyby&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;pwr_flyby&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;LT_rndzvs&#39;</span><span class="p">:</span>
                    <span class="n">Rvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">unitstring</span> <span class="o">=</span> <span class="s1">&#39;LU&#39;</span>
                <span class="k">if</span> <span class="s1">&#39;sun&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_body</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LU</span> <span class="o">-</span> <span class="mf">149597870.69100001</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
                    <span class="n">unitstring</span> <span class="o">=</span> <span class="s1">&#39;AU&#39;</span>
                <span class="n">labelstring</span> <span class="o">=</span> <span class="s1">&#39;Distance from &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_body</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">unitstring</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">Rvector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">labelstring</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">Rvector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1">#plot velocity</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotV</span><span class="p">:</span>
            <span class="n">Vvector</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;match_point&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;upwr_flyby&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;pwr_flyby&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;LT_rndzvs&#39;</span><span class="p">:</span>
                    <span class="n">Vvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">TU</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">Vvector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Velocity magnitude (LU/TU)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">Vvector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">)</span>

        <span class="c1">#plot Thrust</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotThrust</span><span class="p">:</span>
            <span class="n">Thrustvector</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">shortDateVector</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="n">epoch</span> <span class="o">=</span> <span class="n">astropy</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Time</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">JulianDate</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;jd&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;tdb&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">]:</span>
                    <span class="n">Thrustvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mf">10.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                    <span class="n">Thrustvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mf">10.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">:</span>
                    <span class="n">Thrustvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">AvailableThrust</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">thruster_duty_cycle</span><span class="o">*</span><span class="mf">10.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                    <span class="n">Thrustvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">AvailableThrust</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">thruster_duty_cycle</span><span class="o">*</span><span class="mf">10.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;match_point&#39;</span><span class="p">:</span>
                    <span class="n">Thrustvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                    <span class="n">Thrustvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>


            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">Thrustvector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Applied thrust (0.1 N)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">Thrustvector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

        <span class="c1">#plot Isp</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotIsp</span><span class="p">:</span>
            <span class="n">Ispvector</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">shortDateVector</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="n">epoch</span> <span class="o">=</span> <span class="n">astropy</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Time</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">JulianDate</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;jd&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;tdb&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">Ispvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Isp</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                    <span class="n">Ispvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Isp</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;match_point&#39;</span><span class="p">:</span>
                    <span class="n">Ispvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                    <span class="n">Ispvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">Ispvector</span><span class="p">,</span> <span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Isp (1000 s)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">Ispvector</span><span class="p">,</span> <span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">)</span>

        <span class="c1">#plot mass flow rate</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotMdot</span><span class="p">:</span>
            <span class="n">Mdotvector</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">shortDateVector</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="n">epoch</span> <span class="o">=</span> <span class="n">astropy</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Time</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">JulianDate</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;jd&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;tdb&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">Mdotvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="mf">1.0e6</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                    <span class="n">Mdotvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="mf">1.0e6</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;match_point&#39;</span><span class="p">:</span>
                    <span class="n">Mdotvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                    <span class="n">Mdotvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">Mdotvector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mass flow rate (mg/s)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">Mdotvector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

        <span class="c1">#plot Efficiency</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotEfficiency</span><span class="p">:</span>
            <span class="n">Efficiencyvector</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">shortDateVector</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="n">epoch</span> <span class="o">=</span> <span class="n">astropy</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Time</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">JulianDate</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;jd&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;tdb&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">Efficiencyvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">AvailableThrust</span> <span class="o">*</span> <span class="n">event</span><span class="o">.</span><span class="n">Isp</span> <span class="o">*</span> <span class="mf">9.80665</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2000</span> <span class="o">*</span> <span class="n">event</span><span class="o">.</span><span class="n">ActivePower</span><span class="p">))</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                    <span class="n">Efficiencyvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">AvailableThrust</span> <span class="o">*</span> <span class="n">event</span><span class="o">.</span><span class="n">Isp</span> <span class="o">*</span> <span class="mf">9.80665</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2000</span> <span class="o">*</span> <span class="n">event</span><span class="o">.</span><span class="n">ActivePower</span><span class="p">))</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;match_point&#39;</span><span class="p">:</span>
                    <span class="n">Efficiencyvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                    <span class="n">Efficiencyvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>


            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">Efficiencyvector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;DarkGreen&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Propulsion system efficiency&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">Efficiencyvector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;DarkGreen&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

        <span class="c1">#plot control magnitude</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotThrottle</span><span class="p">:</span>
            <span class="n">Throttlevector</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">shortDateVector</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="n">epoch</span> <span class="o">=</span> <span class="n">astropy</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Time</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">JulianDate</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;jd&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;tdb&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSBIthrust&#39;</span><span class="p">]:</span>
                    <span class="n">Throttlevector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">AvailableThrust</span><span class="p">))</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                    <span class="n">Throttlevector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">AvailableThrust</span><span class="p">))</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSFBthrust&#39;</span><span class="p">]:</span>
                    <span class="n">Throttlevector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">DVmagorThrottle</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                    <span class="n">Throttlevector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">DVmagorThrottle</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">:</span>
                    <span class="n">Throttlevector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                    <span class="n">Throttlevector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;match_point&#39;</span><span class="p">:</span>
                    <span class="n">Throttlevector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
                    <span class="n">Throttlevector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epoch</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">Throttlevector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Control magnitude&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">Throttlevector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

        <span class="c1">#plot power</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotPower</span><span class="p">:</span>
            <span class="n">Powervector</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;match_point&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;upwr_flyby&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;pwr_flyby&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;LT_rndzvs&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">AvailablePower</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">Powervector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">AvailablePower</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">Powervector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">Powervector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;Navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Power available for propulsion (kW)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">Powervector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;Navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">)</span>

        <span class="c1">#plot gamma</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotGamma</span><span class="p">:</span>
            <span class="n">gammavector</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">shortDateVector</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">gammavector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GregorianDate</span><span class="p">,</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>

            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesRight</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">gammavector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;DarkGreen&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\gamma$ (degrees)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesRight</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">gammavector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;DarkGreen&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

        <span class="c1">#plot delta</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotDelta</span><span class="p">:</span>
            <span class="n">deltavector</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">shortDateVector</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">AppliedThrust</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">deltavector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">AppliedThrust</span><span class="p">)</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GregorianDate</span><span class="p">,</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>

            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesRight</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">deltavector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;LightGreen&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\delta$ (degrees)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesRight</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">deltavector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;LightGreen&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

        <span class="c1">#plot PlotVelocityThrustAngle</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotVelocityThrustAngle</span><span class="p">:</span>
            <span class="n">PlotVelocityThrustAngleVector</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">shortDateVector</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">AppliedThrust</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>                    
                    <span class="n">VdotT</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">PlotVelocityThrustAngleVector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span> <span class="n">VdotT</span> <span class="o">/</span> <span class="p">(</span><span class="n">v</span> <span class="o">*</span> <span class="n">AppliedThrust</span><span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GregorianDate</span><span class="p">,</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>

            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesRight</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">PlotVelocityThrustAngleVector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orchid&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;velocity to thrust angle (degrees)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesRight</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">PlotVelocityThrustAngleVector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orchid&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>


        <span class="c1">#plot central body to thrust vector angle</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotArray_Thrust_Angle</span><span class="p">:</span>
            <span class="n">CBthrustvector</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">shortDateVector</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">AppliedThrust</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">rdotT</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">CBthrustvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="mf">90.0</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span> <span class="n">rdotT</span> <span class="o">/</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">AppliedThrust</span><span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GregorianDate</span><span class="p">,</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>

            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesRight</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">CBthrustvector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;Salmon&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Array to thrust angle (degrees)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesRight</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">CBthrustvector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;Salmon&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>

        <span class="c1">#plot mass</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotMass</span><span class="p">:</span>
            <span class="n">mass</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;match_point&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;upwr_flyby&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;pwr_flyby&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;LT_rndzvs&#39;</span><span class="p">:</span>
                    <span class="n">mass</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Mass</span> <span class="o">*</span> <span class="mf">1.0e-3</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;DarkGrey&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mass (1000 kg)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;DarkGrey&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

        <span class="c1">#plot number of active thrusters</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotNumberOfEngines</span><span class="p">:</span>
            <span class="n">numberofengines</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">shortDateVector</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">numberofengines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">ActivePower</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GregorianDate</span><span class="p">,</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>

            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">numberofengines</span><span class="p">,</span> <span class="s1">&#39;k*&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Number of active thrusters&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">numberofengines</span><span class="p">,</span> <span class="s1">&#39;k*&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

        <span class="c1">#plot power actively used by the thrusters</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotActivePower</span><span class="p">:</span>
            <span class="n">activepowervector</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">shortDateVector</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">activepowervector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">ActivePower</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GregorianDate</span><span class="p">,</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>

            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">activepowervector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;Navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Power used by the propulsion system (kW)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">activepowervector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;Navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

        <span class="c1">#plot waste heat from the propulsion system</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotWasteHeat</span><span class="p">:</span>
            <span class="n">WasteHeatvector</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">shortDateVector</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">WasteHeatvector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">AvailableThrust</span> <span class="o">*</span> <span class="n">event</span><span class="o">.</span><span class="n">Isp</span> <span class="o">*</span> <span class="mf">9.80665</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2000</span> <span class="o">*</span> <span class="n">event</span><span class="o">.</span><span class="n">ActivePower</span><span class="p">))</span> <span class="o">*</span> <span class="n">event</span><span class="o">.</span><span class="n">ActivePower</span> <span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GregorianDate</span><span class="p">,</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>

            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">WasteHeatvector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;Crimson&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Waste heat from propulsion system (kW)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">WasteHeatvector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;Crimson&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

        <span class="c1">#plot Earth distance in LU and SPE angle</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotEarthDistance</span> <span class="ow">or</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSunSpacecraftEarthAngle</span> <span class="ow">or</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSpacecraftViewingAngle</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;sun&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_body</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;getting Earth distance and Sun-Spacecraft-Earth angle is only supported if the central body is the sun&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">de423</span>
                <span class="kn">from</span> <span class="nn">jplephem</span> <span class="kn">import</span> <span class="n">Ephemeris</span>
                <span class="n">eph</span> <span class="o">=</span> <span class="n">Ephemeris</span><span class="p">(</span><span class="n">de423</span><span class="p">)</span>

                <span class="n">EarthDistanceVector</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">SunSpacecraftEarthAngle</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">SpacecraftViewingAngle</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;match_point&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;upwr_flyby&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;pwr_flyby&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;LT_rndzvs&#39;</span><span class="p">:</span>
                    
                        <span class="c1">#get the position of the central body relative to the solar system barycenter</span>
                        <span class="n">cb_relative_to_solar_system_barycenter_in_ICRF</span> <span class="o">=</span> <span class="n">eph</span><span class="o">.</span><span class="n">position</span><span class="p">(</span><span class="s1">&#39;sun&#39;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">JulianDate</span><span class="p">)</span>

                        <span class="c1">#get the position of the Earth relative to the central body</span>
                        <span class="n">embarycenter_in_ICRF</span> <span class="o">=</span> <span class="n">eph</span><span class="o">.</span><span class="n">position</span><span class="p">(</span><span class="s1">&#39;earthmoon&#39;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">JulianDate</span><span class="p">)</span>
                        <span class="n">moonvector_in_ICRF</span> <span class="o">=</span> <span class="n">eph</span><span class="o">.</span><span class="n">position</span><span class="p">(</span><span class="s1">&#39;moon&#39;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">JulianDate</span><span class="p">)</span>
                        <span class="n">Earth_relative_to_solar_system_barycenter_in_ICRF</span> <span class="o">=</span> <span class="n">embarycenter_in_ICRF</span> <span class="o">-</span> <span class="n">moonvector_in_ICRF</span> <span class="o">*</span> <span class="n">eph</span><span class="o">.</span><span class="n">earth_share</span>
                        <span class="n">Earth_relative_to_cb_in_ICRF</span> <span class="o">=</span> <span class="n">Earth_relative_to_solar_system_barycenter_in_ICRF</span> <span class="o">+</span> <span class="n">cb_relative_to_solar_system_barycenter_in_ICRF</span>

                        <span class="c1">#rotate the spacecraft state relative to the central body into the ICRF frame</span>
                        <span class="n">spacecraft_state_relative_to_central_body_in_ICRF</span> <span class="o">=</span> <span class="n">AstroFunctions</span><span class="o">.</span><span class="n">rotate_from_ecliptic_to_equatorial3</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]))</span>

                        <span class="c1">#get the vector from the Earth to the Spacecraft</span>
                        <span class="n">Earth_Spacecraft_Vector</span> <span class="o">=</span> <span class="n">spacecraft_state_relative_to_central_body_in_ICRF</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Earth_relative_to_cb_in_ICRF</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

                        <span class="c1">#return the magnitude of the Earth-centered position vector</span>
                        <span class="n">EarthDistanceVector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Earth_Spacecraft_Vector</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span><span class="p">)</span>

                        <span class="c1">#if applicable, compute sun-spacecraft-Earth angle</span>
                        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSunSpacecraftEarthAngle</span><span class="p">:</span>
                            <span class="n">cosAngle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="o">-</span><span class="n">Earth_Spacecraft_Vector</span><span class="p">,</span> <span class="o">-</span><span class="n">spacecraft_state_relative_to_central_body_in_ICRF</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">spacecraft_state_relative_to_central_body_in_ICRF</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Earth_Spacecraft_Vector</span><span class="p">)</span>
                            <span class="n">SunSpacecraftEarthAngle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">cosAngle</span><span class="p">)</span> <span class="o">*</span> <span class="mf">180.0</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
                            
                        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSpacecraftViewingAngle</span><span class="p">:</span>
                            <span class="n">tanAngle</span> <span class="o">=</span> <span class="n">Earth_Spacecraft_Vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Earth_Spacecraft_Vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Earth_Spacecraft_Vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">Earth_Spacecraft_Vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Earth_Spacecraft_Vector</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                            <span class="n">SpacecraftViewingAngle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">tanAngle</span><span class="p">)</span> <span class="o">*</span> <span class="mf">180.0</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>  
                
                <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotEarthDistance</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                        <span class="n">unitstring</span> <span class="o">=</span> <span class="s1">&#39;LU&#39;</span>
                        <span class="k">if</span> <span class="s1">&#39;sun&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_body</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LU</span> <span class="o">-</span> <span class="mf">149597870.69100001</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
                            <span class="n">unitstring</span> <span class="o">=</span> <span class="s1">&#39;AU&#39;</span>
                        <span class="n">labelstring</span> <span class="o">=</span> <span class="s1">&#39;Distance from Earth (&#39;</span> <span class="o">+</span> <span class="n">unitstring</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
                        <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">EarthDistanceVector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">labelstring</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">EarthDistanceVector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSunSpacecraftEarthAngle</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                        <span class="n">DataAxesRight</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">SunSpacecraftEarthAngle</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orangered&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sun-Spacecraft-Earth Angle&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">DataAxesRight</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">SunSpacecraftEarthAngle</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orangered&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSpacecraftViewingAngle</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                        <span class="n">DataAxesRight</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">SpacecraftViewingAngle</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orangered&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Latitude of Earth-Spacecraft Vector&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">DataAxesRight</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">SpacecraftViewingAngle</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orangered&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span><span class="p">)</span>

        <span class="c1">#plot throttle level</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotThrottleLevel</span><span class="p">:</span>            
            <span class="n">ThrottleLevelVector</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">shortDateVector</span> <span class="o">=</span> <span class="p">[]</span>
        
            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">ThrottleLevelVector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">ThrottleLevel</span><span class="p">)</span>
                    <span class="n">shortDateVector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GregorianDate</span><span class="p">,</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
                    
            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">ThrottleLevelVector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;midnightblue&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;h&#39;</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Throttle level&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>                                                                                   
                <span class="n">DataAxesLeft</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">shortDateVector</span><span class="p">,</span> <span class="n">ThrottleLevelVector</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;midnightblue&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;h&#39;</span> <span class="p">)</span>
                
        <span class="c1">#plot sun-boresight angle</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSunBoresightAngle</span><span class="p">:</span>
            <span class="n">SunBoresightAngle</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span> <span class="s2">&quot;PSBIthrust&quot;</span><span class="p">]:</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">AppliedThrust</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">rdotT</span> <span class="o">=</span> <span class="o">-</span><span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">SunBoresightAngle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span> <span class="n">rdotT</span> <span class="o">/</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">AppliedThrust</span><span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;match_point&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;upwr_flyby&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;pwr_flyby&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">!=</span> <span class="s1">&#39;LT_rndzvs&#39;</span><span class="p">:</span>
                    <span class="n">SunBoresightAngle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">firstpass</span><span class="p">:</span>
                <span class="n">DataAxesRight</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">SunBoresightAngle</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sun-to-Boresight angle (degrees)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">DataAxesRight</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_vector</span><span class="p">,</span> <span class="n">SunBoresightAngle</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span></div>

        
        <span class="c1">#DataAxesLeft.set_ylim(bottom=-0.7)</span>
        <span class="c1">#DataAxesRight.set_ylim(bottom=-0.7)</span>
        <span class="c1">#DataAxesLeft.set_ylim([-0.2,2.5])</span>
        <span class="c1">#DataAxesLeft.set_ylim([-0.2,2.5])</span>

<div class="viewcode-block" id="Journey.WriteDateReport">
<a class="viewcode-back" href="../PyEMTG/Journey.html#Journey.Journey.WriteDateReport">[docs]</a>
    <span class="k">def</span> <span class="nf">WriteDateReport</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="p">,</span> <span class="n">reportfile</span><span class="p">):</span>
        <span class="c1">#write header</span>
        <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;JD, MM-DD-YYYY, Event duration (days), Event type, Event location&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">IncludeStateVectorInReport</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;,x (km), y (km), z (km), xdot (km/s), ydot (km/s), zdot (km/s)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotR</span><span class="p">:</span>
            <span class="n">unitstring</span> <span class="o">=</span> <span class="s1">&#39;LU&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;sun&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_body</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LU</span> <span class="o">-</span> <span class="mf">149597870.69100001</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
                <span class="n">unitstring</span> <span class="o">=</span> <span class="s1">&#39;AU&#39;</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Distance from &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_body</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">unitstring</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotV</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Velocity magnitude (LU/TU)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotThrust</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Applied thrust (N)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotIsp</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Isp (s)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotMdot</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Mass flow rate (kg/s)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotEfficiency</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Propulsion system efficiency&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotThrottle</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Control magnitude&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotPower</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Power produced by spacecraft (kW)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotGamma</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, in-plane control angle (degrees)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotDelta</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, out-of-plane control angle (degrees)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotVelocityThrustAngle</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, velocity to thrust angle (degrees)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotArray_Thrust_Angle</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Array to thrust angle (degrees)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotMass</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Mass (kg)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotNumberOfEngines</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Number of active thrusters&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotActivePower</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Power used by the propulsion system (kW)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotWasteHeat</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Waste heat from propulsion system (kW)&#39;</span><span class="p">)</span>  
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotEarthDistance</span><span class="p">:</span>
            <span class="n">unitstring</span> <span class="o">=</span> <span class="s1">&#39;LU&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;sun&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_body</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LU</span> <span class="o">-</span> <span class="mf">149597870.69100001</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
                <span class="n">unitstring</span> <span class="o">=</span> <span class="s1">&#39;AU&#39;</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Distance from Earth (&#39;</span> <span class="o">+</span> <span class="n">unitstring</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSunSpacecraftEarthAngle</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Sun-Spacecraft-Earth Angle&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSpacecraftViewingAngle</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Latitude of Earth-Spacecraft Vector&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotThrottleLevel</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Throttle level&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSunBoresightAngle</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, Sun-Boresight Angle&#39;</span><span class="p">)</span>
        <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1">#load stuff if necessary</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotEarthDistance</span> <span class="ow">or</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSunSpacecraftEarthAngle</span> <span class="ow">or</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSpacecraftViewingAngle</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;sun&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_body</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;getting Earth distance and Sun-Spacecraft-Earth angle is only supported if the central body is the sun&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">de423</span>
                <span class="kn">from</span> <span class="nn">jplephem</span> <span class="kn">import</span> <span class="n">Ephemeris</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">eph</span> <span class="o">=</span> <span class="n">Ephemeris</span><span class="p">(</span><span class="n">de423</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotThrottleLevel</span><span class="p">:</span>
            <span class="c1">#instantiate a throttle table object</span>
            <span class="n">thruster_throttle_table</span> <span class="o">=</span> <span class="n">ThrottleTable</span><span class="o">.</span><span class="n">ThrottleTable</span><span class="p">(</span><span class="n">PlotOptions</span><span class="o">.</span><span class="n">throttletablefile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">high_Mdot_set</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_Mdot_set</span> <span class="o">=</span> <span class="n">thruster_throttle_table</span><span class="o">.</span><span class="n">create_non_dominated_sets</span><span class="p">()</span>

        <span class="c1">#now print the report</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">JulianDate</span><span class="p">))</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">GregorianDate</span><span class="p">)</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">TimestepLength</span><span class="p">))</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span><span class="p">)</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Location</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">IncludeStateVectorInReport</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotR</span><span class="p">:</span>
                <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotV</span><span class="p">:</span>
                <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">TU</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotThrust</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;match_point&#39;</span><span class="p">,</span><span class="s1">&#39;upwr_flyby&#39;</span><span class="p">,</span><span class="s1">&#39;pwr_flyby&#39;</span><span class="p">,</span><span class="s1">&#39;LT_rndzvs&#39;</span><span class="p">,</span><span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
                <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">AvailableThrust</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">thruster_duty_cycle</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, 0.0&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotIsp</span><span class="p">:</span>
                <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Isp</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotMdot</span><span class="p">:</span>
                <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">MassFlowRate</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotEfficiency</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span><span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">AvailableThrust</span> <span class="o">*</span> <span class="n">event</span><span class="o">.</span><span class="n">Isp</span> <span class="o">*</span> <span class="mf">9.80665</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2000</span> <span class="o">*</span> <span class="n">event</span><span class="o">.</span><span class="n">ActivePower</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, 0.0&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotThrottle</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSFBthrust&#39;</span><span class="p">]:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">AvailableThrust</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">thruster_duty_cycle</span><span class="p">)))</span>
                <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">1.0</span><span class="p">))</span>
                <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;match_point&#39;</span><span class="p">,</span><span class="s1">&#39;upwr_flyby&#39;</span><span class="p">,</span><span class="s1">&#39;pwr_flyby&#39;</span><span class="p">,</span><span class="s1">&#39;LT_rndzvs&#39;</span><span class="p">]:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotPower</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;match_point&#39;</span><span class="p">,</span><span class="s1">&#39;upwr_flyby&#39;</span><span class="p">,</span><span class="s1">&#39;pwr_flyby&#39;</span><span class="p">,</span><span class="s1">&#39;LT_rndzvs&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">AvailablePower</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">):</span>
                        <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">AvailablePower</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotGamma</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span><span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotDelta</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span><span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">AppliedThrust</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">AppliedThrust</span><span class="p">)</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotVelocityThrustAngle</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">AppliedThrust</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>                                        
                    <span class="n">VdotT</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span> <span class="n">VdotT</span> <span class="o">/</span> <span class="p">(</span><span class="n">v</span> <span class="o">*</span> <span class="n">AppliedThrust</span><span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">reportFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotArray_Thrust_Angle</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span><span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">AppliedThrust</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">rdotT</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span> <span class="n">rdotT</span> <span class="o">/</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">AppliedThrust</span><span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotMass</span><span class="p">:</span>
                <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Mass</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotNumberOfEngines</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span><span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Number_of_Active_Engines</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotActivePower</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span><span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">ActivePower</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotWasteHeat</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span><span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span><span class="s1">&#39;LT_spiral&#39;</span><span class="p">]:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">AvailableThrust</span> <span class="o">*</span> <span class="n">event</span><span class="o">.</span><span class="n">Isp</span> <span class="o">*</span> <span class="mf">9.80665</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2000.0</span> <span class="o">*</span> <span class="n">event</span><span class="o">.</span><span class="n">ActivePower</span><span class="p">))</span> <span class="o">*</span> <span class="n">event</span><span class="o">.</span><span class="n">ActivePower</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotEarthDistance</span> <span class="ow">or</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSunSpacecraftEarthAngle</span> <span class="ow">or</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSpacecraftViewingAngle</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;sun&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_body</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;getting Earth distance and Sun-Spacecraft-Earth angle is only supported if the central body is the sun&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1">#get the position of the central body relative to the solar system barycenter</span>
                    <span class="n">cb_relative_to_solar_system_barycenter_in_ICRF</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eph</span><span class="o">.</span><span class="n">position</span><span class="p">(</span><span class="s1">&#39;sun&#39;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">JulianDate</span><span class="p">)</span>

                    <span class="c1">#get the position of the Earth relative to the central body</span>
                    <span class="n">embarycenter_in_ICRF</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eph</span><span class="o">.</span><span class="n">position</span><span class="p">(</span><span class="s1">&#39;earthmoon&#39;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">JulianDate</span><span class="p">)</span>
                    <span class="n">moonvector_in_ICRF</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eph</span><span class="o">.</span><span class="n">position</span><span class="p">(</span><span class="s1">&#39;moon&#39;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">JulianDate</span><span class="p">)</span>
                    <span class="n">Earth_relative_to_solar_system_barycenter_in_ICRF</span> <span class="o">=</span> <span class="n">embarycenter_in_ICRF</span> <span class="o">-</span> <span class="n">moonvector_in_ICRF</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">eph</span><span class="o">.</span><span class="n">earth_share</span>
                    <span class="n">Earth_relative_to_cb_in_ICRF</span> <span class="o">=</span> <span class="n">Earth_relative_to_solar_system_barycenter_in_ICRF</span> <span class="o">+</span> <span class="n">cb_relative_to_solar_system_barycenter_in_ICRF</span>

                    <span class="c1">#rotate the spacecraft state relative to the central body into the ICRF frame</span>
                    <span class="n">spacecraft_state_relative_to_central_body_in_ICRF</span> <span class="o">=</span> <span class="n">AstroFunctions</span><span class="o">.</span><span class="n">rotate_from_ecliptic_to_equatorial3</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]))</span>

                    <span class="c1">#get the vector from the Earth to the Spacecraft</span>
                    <span class="n">Earth_Spacecraft_Vector</span> <span class="o">=</span> <span class="n">spacecraft_state_relative_to_central_body_in_ICRF</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Earth_relative_to_cb_in_ICRF</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="c1">#return the magnitude of the Earth-centered position vector</span>
                    <span class="n">EarthDistance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Earth_Spacecraft_Vector</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span>

                    <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotEarthDistance</span><span class="p">:</span>
                        <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">EarthDistance</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSunSpacecraftEarthAngle</span><span class="p">:</span>
                        <span class="n">cosAngle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="o">-</span><span class="n">Earth_Spacecraft_Vector</span><span class="p">,</span> <span class="o">-</span><span class="n">spacecraft_state_relative_to_central_body_in_ICRF</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">spacecraft_state_relative_to_central_body_in_ICRF</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Earth_Spacecraft_Vector</span><span class="p">)</span>
                        <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">cosAngle</span><span class="p">)</span> <span class="o">*</span> <span class="mf">180.0</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSpacecraftViewingAngle</span><span class="p">:</span>
                        <span class="n">tanAngle</span> <span class="o">=</span> <span class="n">Earth_Spacecraft_Vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Earth_Spacecraft_Vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Earth_Spacecraft_Vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">Earth_Spacecraft_Vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Earth_Spacecraft_Vector</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">tanAngle</span><span class="p">)</span> <span class="o">*</span> <span class="mf">180.0</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>   
                        
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotThrottleLevel</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;PSBIthrust&#39;</span><span class="p">,</span><span class="s1">&#39;PSFBthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;end_spiral&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">throttlesetmode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">high_Mdot_set</span><span class="o">.</span><span class="n">find_nearest_throttle_setting_1D</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">ActivePower</span> <span class="o">/</span> <span class="n">event</span><span class="o">.</span><span class="n">Number_of_Active_Engines</span><span class="p">)</span><span class="o">.</span><span class="n">TL</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;TL&#39;</span><span class="p">))))</span>
                    <span class="k">elif</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">throttlesetmode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">low_Mdot_set</span><span class="o">.</span><span class="n">find_nearest_throttle_setting_1D</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">ActivePower</span> <span class="o">/</span> <span class="n">event</span><span class="o">.</span><span class="n">Number_of_Active_Engines</span><span class="p">)</span><span class="o">.</span><span class="n">TL</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;TL&#39;</span><span class="p">))))</span>
                    <span class="k">elif</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">throttlesetmode</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2D throttle matching not currently implemented&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>
            <span class="c1">#plot sun-boresight angle</span>
            <span class="k">if</span> <span class="n">PlotOptions</span><span class="o">.</span><span class="n">PlotSunBoresightAngle</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;SSFthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTSthrust&#39;</span><span class="p">,</span> <span class="s1">&#39;FBLTthrust&#39;</span><span class="p">,</span> <span class="s2">&quot;PSBIthrust&quot;</span><span class="p">,</span><span class="s1">&#39;PSFBthrust&#39;</span><span class="p">]:</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">AppliedThrust</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">rdotT</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">Thrust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span> <span class="n">rdotT</span> <span class="o">/</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">AppliedThrust</span><span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>
            <span class="n">reportfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Journey.AutoTableJourney">
<a class="viewcode-back" href="../PyEMTG/Journey.html#Journey.Journey.AutoTableJourney">[docs]</a>
    <span class="k">def</span> <span class="nf">AutoTableJourney</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">TableFile</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="p">,</span> <span class="n">skipNext</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
            <span class="n">skipNext</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">AutoTableLine</span><span class="p">(</span><span class="n">TableFile</span><span class="p">,</span> <span class="n">PlotOptions</span><span class="p">,</span> <span class="n">skipNext</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">skipNext</span></div>


<div class="viewcode-block" id="Journey.getManeuver">
<a class="viewcode-back" href="../PyEMTG/Journey.html#Journey.Journey.getManeuver">[docs]</a>
    <span class="k">def</span> <span class="nf">getManeuver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phaseIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">maneuverIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c1">#function to get the nth DSM/TCM in a phase</span>
        <span class="c1">#if that maneuver does not exist, return None</span>
        
        <span class="c1">#Step 1: search through the journey to find the right phase. We do this by counting the number of boundary events until we get to the end of the journey or the phase that we want</span>
        <span class="c1">#since phase boundaries are always upwr_flyby or pwr_flyby, this isn&#39;t too hard!</span>
        <span class="n">phaseCount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">maneuverCount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">event</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pwr_flyby&#39;</span><span class="p">,</span><span class="s1">&#39;upwr_flyby&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">index</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
                <span class="c1"># don&#39;t increment phaseCount if index == 0 because that just means we are starting the journey with</span>
                <span class="c1"># a flyby -- we are still on phase 0</span>
                <span class="n">phaseCount</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">maneuverCount</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;chem_burn&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">maneuverCount</span> <span class="o">==</span> <span class="n">maneuverIndex</span> <span class="ow">and</span> <span class="n">phaseCount</span> <span class="o">==</span> <span class="n">phaseIndex</span><span class="p">:</span>
                    <span class="c1">#this is the maneuver that we want, so return it</span>
                    <span class="k">return</span> <span class="n">event</span>
                
                <span class="c1">#if we didn&#39;t just return, increment the maneuver count</span>
                <span class="n">maneuverCount</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1">#if we got this far then the event that the user asked for does not exist, so return &quot;none&quot;</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Journey.getPeriapseDistance">
<a class="viewcode-back" href="../PyEMTG/Journey.html#Journey.Journey.getPeriapseDistance">[docs]</a>
    <span class="k">def</span> <span class="nf">getPeriapseDistance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">r_min</span> <span class="o">=</span> <span class="mf">1.0e+10</span>

        <span class="k">if</span> <span class="n">scale</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LU</span>

        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="n">SpacecraftState</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>

            <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">r_min</span><span class="p">:</span>
                <span class="n">r_min</span> <span class="o">=</span> <span class="n">r</span>

        <span class="k">return</span> <span class="n">r_min</span> <span class="o">/</span> <span class="n">scale</span></div>

    
<div class="viewcode-block" id="Journey.getMGAPhaseUnpoweredFlyby">
<a class="viewcode-back" href="../PyEMTG/Journey.html#Journey.Journey.getMGAPhaseUnpoweredFlyby">[docs]</a>
    <span class="k">def</span> <span class="nf">getMGAPhaseUnpoweredFlyby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method returns missionevent object for an unpowered flyby in an MGA phase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : Integer, optional</span>
<span class="sd">            The index of the unpowered flyby to return. The default is 0.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># search through the journey to find the right event</span>
        <span class="n">flybyCount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missionevents</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">EventType</span> <span class="o">==</span> <span class="s1">&#39;upwr_flyby&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">flybyCount</span> <span class="o">==</span> <span class="n">index</span><span class="p">:</span>
                    <span class="c1"># we found what we are looking for</span>
                    <span class="k">return</span> <span class="n">event</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># not yet!</span>
                    <span class="n">flybyCount</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="c1"># if we got this far, then the event the user requrested does not exist</span>
        <span class="k">return</span> <span class="kc">None</span></div>
</div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">EMTG python</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../PyEMTG/index.html">PyEMTG documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PEATSA/index.html">PEATSA documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OptionsOverhaul/index.html">OptionsOverhaul documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Jacob Englander, Donald Ellison, Jeremy Knittel, Noble Hatten.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
    </div>

    

    
  </body>
</html>